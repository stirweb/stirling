const renderDivider=()=>'<div class="cell"><hr /></div>',renderNoItemsMessage=e=>`<div class="cell">${e}</div>`,renderHeader=(e,t)=>e||t?`<div class="cell u-mt-2">
    ${e?`<h2>${e}</h2>`:""}
    ${t}
  </div>`:"",renderDateTime=e=>`<p class="text-sm u-m-0">
    <strong>${e.date}, ${e.time} ${e.timeend?"to "+e.timeend:""} (${e.zone})</strong>
  </p>`,renderItem=e=>{var t=e.ondemand&&!e.isupcoming?'<span class="u-bg-heritage-berry u-white u-px-tiny u-py-xtiny text-xxsm">Watch on-demand</span>':e.isupcoming?'<span class="u-bg-heritage-green u-white u-px-tiny u-py-xtiny text-xxsm">Live event</span>':"";return`
    <div class="cell small-12 large-4 medium-6 u-mb-3">
      <div class="u-border-width-4 ${e.ondemand&&!e.isupcoming?"u-heritage-berry-line-left":"u-heritage-line-left"} u-p-2 u-relative u-bg-white u-h-full">
        <div class="u-absolute u-top--16">${t}</div>
        <h3 class="u-header--secondary-font u-text-regular u-black header-stripped u-m-0 u-py-2">
          <a href="${e.link}" class="u-border-bottom-hover u-border-width-2">${e.title}</a>
        </h3>
        ${e.isupcoming?renderDateTime(e):""}
        <div class="text-sm">${e.description}</div>
        <p class="text-sm">Audience: ${e.studylevels} students. ${e.countries}</p>
      </div>
    </div>`},renderAllItems=stir.curry((e,t)=>t.length||e.noItems?`
    <div class="grid-x grid-padding-x">
      ${renderHeader(e.head,e.intro)}
      ${t.length?t.map(renderItem).join(""):renderNoItemsMessage(e.noItems)}
      ${e.divider&&"no"===e.divider?"":renderDivider()}
    </div>`:""),renderSummary=e=>`<p class="u-pb-2 text-sm">Results based on filters - <strong>${e} webinars</strong></p>`,renderPaginationSummary=(e,t,r)=>`<p class="u-pb-2 text-sm text-center"><strong>Displaying ${e+1} to ${t} of ${r} results</strong></p>`,renderLoadMoreButon=()=>'<div class="text-center"><button class="button hollow tiny u-bg-white" data-loadmore>Load more results</button></div>',renderNoData=e=>`<p class="text-center text-sm">${e}</p>`,getRegionString=(e,t)=>e.filter(e=>e.tag===t).map(e=>e.data).join(", "),matchTag=(e,t,r)=>e.includes(r)||t.trim().includes(r),matcher=stir.curry((e,t,r,i)=>{if(t.includes(i.trim())||i.trim().includes(t.trim()))return!0;if("faculties"===r&&matchTag(t,i,"All Faculties"))return!0;if("countries"===r){if(matchTag(t,i,"All nationalities"))return!0;var a;if(t.includes("All international"))return r=getRegionString(e.macros,"United Kingdom"),a=getRegionString(e.macros,"RUK"),!r.includes(i.trim())&&!a.includes(i.trim())&&i.trim();if(e.macros.filter(e=>e.data.includes(t)).map(e=>e.tag).includes(i))return!0;r=e.macros.filter(e=>e.tag===t);if(r.length&&r[0].data.includes(i))return!0}return!1}),filterer=stir.curry((t,r,i)=>{return Object.keys(r).filter(e=>t.safeList.includes(e)).every(e=>{return i[e]?i[e].split(", ").some(matcher(t,r[e],e)):""===r[e]})}),getISONow=()=>Number((new Date).toISOString().split(".")[0].replaceAll(/[-:T]/g,"")),isPast=e=>!e.isupcoming,isUpcoming=e=>e.isupcoming,isOnDemand=e=>e.ondemand,isUpcomingByDate=t=>e=>Number(e.datetime)>t,sortByDatetime=(e,t)=>parseInt(e.datetime)-parseInt(t.datetime),setDOMContent=stir.curry((e,t)=>(stir.setHTML(e,t),e)),appendDOMContent=stir.curry((e,t)=>(e.insertAdjacentHTML("beforeend",t),e)),cleanQueryParam=e=>"string"!=typeof e?"":e.replace(/[^a-zA-Z0-9-_]/g,""),SafeQueryParams={get:e=>cleanQueryParam(QueryParams.get(e)),set:(e,t)=>QueryParams.set(e,cleanQueryParam(t)),remove:QueryParams.remove};function main(e,a,t,s,n){const r=getISONow();var t=stir.compose(stir.filter(filterer(e,s.params)),stir.map(e=>({...e,isupcoming:isUpcomingByDate(r)(e)})),stir.filter(e=>e.title))(t),i=stir.compose(stir.sort(sortByDatetime),stir.filter(isUpcoming))(t),o=stir.compose(stir.sort((e,t)=>-sortByDatetime(e,t)),stir.filter(isOnDemand),stir.filter(isPast))(t),l=[...i,...o],t=e["itemsPerPage"];const d=t*(s.page-1),c=d+t;var u=(e,t)=>{var r=0==d?renderSummary(e.length):renderPaginationSummary(d,c,e.length),i=e.length>c?renderLoadMoreButon():renderNoData("No more items to load");return("new"===n?setDOMContent:appendDOMContent)(a)(r+renderAllItems(s)(e.slice(d,c))+i)};switch(s.params.view){case"live":return u(i);case"ondemand":return u(o);default:return l.slice(d,c).length?u(l):setDOMContent(a,"<p>No webinars found</p>")}}function doForm(e,t,r,i,a){a=new FormData(a),a=Object.fromEntries(a.entries()),Object.entries(a).forEach(([e,t])=>SafeQueryParams.set(e,t)),a={page:SafeQueryParams.get("page"),params:{series:"",countries:a.region,subjects:"",studylevels:a.studylevel,faculties:"",categories:a.category,view:a.view},divider:"no"};main(e,t,r,a,i),""===t.innerHTML&&setDOMContent(t,"<p>No webinars found</p>")}const handleFormChange=(e,t,r)=>()=>doForm(e,t,r,"new",stir.node("#webinarfilters")),handleRadioClick=(i,a,s)=>(e,t)=>{SafeQueryParams.set("page","1");var r=0===t?"onload":"click";e.target.value===SafeQueryParams.get("view")&&0<t||(doForm(i,a,s,"new",stir.node("#webinarfilters")),stir.nodes("#webinarfilters input").forEach(e=>e.closest("div").classList.remove("u-bg-grey","u-energy-line-top")),e.target.closest("div").classList.add("u-bg-grey","u-energy-line-top"),handleTabScroll(e.target,stir.node("#radioTabs"),r))},handlePagination=(r,i,a)=>e=>{var t;"BUTTON"===e.target.nodeName&&(t=Number(SafeQueryParams.get("page"))||1,SafeQueryParams.set("page",String(t+1)),doForm(r,i,a,"append",stir.node("#webinarfilters")),e.target.scrollIntoView({behavior:"smooth"}),e.target.classList.add("hide"))};function handleTabScroll(i,a,e){var t=i.closest("div").offsetWidth,r=a.parentElement.getBoundingClientRect(),s=i.closest("div").getBoundingClientRect();s.right>r.width&&(a.scrollBy({left:t,behavior:"smooth"}),"onload"===e)&&setTimeout(()=>{var e=i.closest("div").getBoundingClientRect().right,t=a.parentElement.getBoundingClientRect().right,r=window.screen.width-t;e<t&&a.scrollBy({left:e-t+2*r,behavior:"smooth"})},500),s.left<r.left&&a.scrollBy({left:-t,behavior:"smooth"})}function initWebinarFinder(r,i){const a=stir.node("#webinarresults");if(a){SafeQueryParams.set("page","1");const s={category:SafeQueryParams.get("category")?SafeQueryParams.get("category"):"",studylevel:SafeQueryParams.get("studylevel")?SafeQueryParams.get("studylevel"):"",region:SafeQueryParams.get("region")?SafeQueryParams.get("region"):"",view:SafeQueryParams.get("view")?SafeQueryParams.get("view"):"",page:1};var e={page:s.page,params:{series:"",countries:s.region,subjects:"",studylevels:s.studylevel,faculties:"",categories:s.category,view:s.view},divider:"no"};main(r,a,i,e,"new"),""===a.innerHTML&&setDOMContent(a,"<p>No webinars found</p>"),stir.nodes("#webinarfilters select").forEach(e=>{e.value=s[e.name],e.addEventListener("change",handleFormChange(r,a,i))}),stir.nodes("#webinarfilters input").forEach(e=>{let t=0;e.addEventListener("click",e=>handleRadioClick(r,a,i)(e,t++)),e.value===s[e.name]&&(e.checked=!0,e.closest("div").classList.add("u-bg-grey","u-energy-line-top"),e.click())}),a.addEventListener("click",handlePagination(r,a,i))}}function initWebinarSections(t,r,i){var e=stir.nodes("[data-webinarSects]"),a=(e.forEach(e=>{main(t,e,r,i[e.dataset.webinarsects],"onload")}),stir.node("[data-webinardisclaimer]"));a&&e.map(e=>e.innerText).join("").trim().length<1&&setDOMContent(a,stir.t4Globals.webinarsdisclaimer||"")}!function(){var e,t,r,i;stir.nodes("[data-webinar]")&&(e={itemsPerPage:6,safeList:["countries","series","subjects","studylevels","faculties","categories"],macros:(stir.t4Globals.regionmacros||[]).filter(e=>e.tag)},r=stir.t4Globals.webinars||[],t=stir.t4Globals.webinarSectionData||{},i="id",initWebinarFinder(e,r=r.reduce((e,t)=>{return e.find(e=>e[i]===t[i])?e:[...e,t]},[])),initWebinarSections(e,r,t))}();