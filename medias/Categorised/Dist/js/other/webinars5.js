const renderDivider=()=>'<div class="cell"><hr /></div>',renderNoItemsMessage=e=>`<div class="cell">${e}</div>`,renderHeader=(e,t)=>e||t?`<div class="cell u-mt-2">
    ${e?`<h2>${e}</h2>`:""}
    ${t}
  </div>`:"",renderRadioTab=(e,t)=>`<div class="u-border-width-4 u-px-1 u-white-line-top u-bg-medium-grey u-mr-tiny u-box-size-border">
              <label for="${e}" class="u-cursor-pointer u-p-1 text-sm inline-block u-w-full u-whitespace-nowrap">
              <input type="radio" id="${e}" name="view" class="hide" value="${e.replace("view","")}" />${t}</label>
          </div>`,renderDateTime=e=>`<p class="text-sm u-m-0">
    <strong>${e.date}, ${e.time} ${e.timeend?"to "+e.timeend:""} (${e.zone})</strong>
  </p>`,renderItem=e=>{var t=e.ondemand&&!e.isupcoming?'<span class="u-bg-heritage-berry u-white u-px-tiny u-py-xtiny text-xxsm">Watch on-demand</span>':e.isupcoming?'<span class="u-bg-heritage-green u-white u-px-tiny u-py-xtiny text-xxsm">Live event</span>':"";return`
    <div class="cell small-12 large-4 medium-6 u-mb-3">
      <div class="u-border-width-4 ${e.ondemand&&!e.isupcoming?"u-heritage-berry-line-left":"u-heritage-line-left"} u-p-2 u-relative u-bg-white u-h-full">
        <div class="u-absolute u-top--16">${t}</div>
        <h3 class="u-header--secondary-font u-text-regular u-black header-stripped u-m-0 u-py-2">
          <a href="${e.link}" class="u-border-bottom-hover u-border-width-2">${e.title}</a>
        </h3>
        ${e.isupcoming?renderDateTime(e):""}
        <div class="text-sm">${e.description}</div>
        <p class="text-sm">Audience: ${e.studylevels} students. ${e.countries}</p>
      </div>
    </div>`},renderAllItems=stir.curry((e,t)=>t.length||e.noItems?`
    <div class="grid-x grid-padding-x">
      ${renderHeader(e.head,e.intro)}
      ${t.length?t.map(renderItem).join(""):renderNoItemsMessage(e.noItems)}
      ${e.divider&&"no"===e.divider?"":renderDivider()}
    </div>`:""),renderSummary=e=>`<p class="u-pb-2 text-sm">Results based on filters - <strong>${e} webinars</strong></p>`,renderPaginationSummary=(e,t,r)=>`<p class="u-pb-2 text-sm text-center"><strong>Displaying ${e+1} to ${t} of ${r} results</strong></p>`,renderLoadMoreButon=()=>'<div class="text-center"><button class="button hollow tiny u-bg-white" data-loadmore>Load more results</button></div>',renderNoData=e=>`<p class="text-center text-sm">${e}</p>`,getRegionString=(e,t)=>e.filter(e=>e.tag===t).map(e=>e.data).join(", "),matchTag=(e,t,r)=>e.includes(r)||t.trim().includes(r),matcher=stir.curry((e,t,r,a)=>{if(t.includes(a.trim())||a.trim().includes(t.trim()))return!0;if("faculties"===r&&matchTag(t,a,"All Faculties"))return!0;if("countries"===r){if(matchTag(t,a,"All nationalities"))return!0;var i;if(t.includes("All international"))return r=getRegionString(e.macros,"United Kingdom"),i=getRegionString(e.macros,"RUK"),!r.includes(a.trim())&&!i.includes(a.trim())&&a.trim();if(e.macros.filter(e=>e.data.includes(t)).map(e=>e.tag).includes(a))return!0;r=e.macros.filter(e=>e.tag===t);if(r.length&&r[0].data.includes(a))return!0}return!1}),filterer=stir.curry((t,r,a)=>{return Object.keys(r).filter(e=>t.safeList.includes(e)).every(e=>{return a[e]?a[e].split(", ").some(matcher(t,r[e],e)):""===r[e]})}),getISONow=()=>Number((new Date).toISOString().split(".")[0].replaceAll(/[-:T]/g,"")),isPast=e=>!e.isupcoming,isUpcoming=e=>e.isupcoming,isOnDemand=e=>e.ondemand,isUpcomingByDate=t=>e=>Number(e.datetime)>t,sortByDatetime=(e,t)=>parseInt(e.datetime)-parseInt(t.datetime),setDOMContent=stir.curry((e,t)=>(stir.setHTML(e,t),e)),appendDOMContent=stir.curry((e,t)=>(e.insertAdjacentHTML("beforeend",t),e)),cleanQueryParam=e=>"string"!=typeof e?"":e.replace(/[^a-zA-Z0-9-_]/g,""),SafeQueryParams={get:e=>cleanQueryParam(QueryParams.get(e)),set:(e,t)=>QueryParams.set(e,cleanQueryParam(t)),remove:QueryParams.remove};function main(e,i,t,n,s){const r=getISONow();var t=stir.compose(stir.filter(filterer(e,n.params)),stir.map(e=>({...e,isupcoming:isUpcomingByDate(r)(e)})),stir.filter(e=>e.title))(t),a=stir.compose(stir.sort(sortByDatetime),stir.filter(isUpcoming))(t),o=stir.compose(stir.sort((e,t)=>-sortByDatetime(e,t)),stir.filter(isOnDemand),stir.filter(isPast))(t),d=[...a,...o],t=e["itemsPerPage"];const l=t*(n.page-1),u=l+t;(a.length&&!stir.node("#viewlive")||"live"===n.params.view&&!stir.node("#viewlive"))&&appendDOMContent(e.radioTabs,renderRadioTab("viewlive","View live")),(o.length&&!stir.node("#viewondemand")||"ondemand"===n.params.view&&!stir.node("#viewondemand"))&&appendDOMContent(e.radioTabs,renderRadioTab("viewondemand","On demand"));var c=(e,t)=>{var r=0==l?renderSummary(e.length):renderPaginationSummary(l,u,e.length),a=e.length>u?renderLoadMoreButon():renderNoData("No more items to load");return("new"===s?setDOMContent:appendDOMContent)(i)(r+renderAllItems(n)(e.slice(l,u))+a)};switch(n.params.view){case"live":return c(a);case"ondemand":return c(o);default:return d.slice(l,u).length?null:setDOMContent(i,"<p>No webinars found</p>")}}function doForm(e,t,r,a,i){i=new FormData(i),i=Object.fromEntries(i.entries()),Object.entries(i).forEach(([e,t])=>SafeQueryParams.set(e,t)),i={page:SafeQueryParams.get("page"),params:{series:"",countries:i.region,subjects:"",studylevels:i.studylevel,faculties:"",categories:i.category,view:i.view},divider:"no"};main(e,t,r,i,a),""===t.innerHTML&&setDOMContent(t,"<p>No webinars found</p>")}const handleFormChange=(e,t,r)=>()=>{SafeQueryParams.set("page","1"),doForm(e,t,r,"new",stir.node("#webinarfilters"))},handleRadioClick=(t,r,a)=>e=>{SafeQueryParams.set("view",e.target.value),SafeQueryParams.set("page","1"),doForm(t,r,a,"new",stir.node("#webinarfilters")),stir.nodes("#webinarfilters input").forEach(e=>e.closest("div").classList.remove("u-bg-grey","u-energy-line-top")),e.target.closest("div").classList.add("u-bg-grey","u-energy-line-top")},handlePagination=(r,a,i)=>e=>{var t;"BUTTON"===e.target.nodeName&&(t=Number(SafeQueryParams.get("page"))||1,SafeQueryParams.set("page",String(t+1)),doForm(r,a,i,"append",stir.node("#webinarfilters")),e.target.scrollIntoView({behavior:"smooth"}),e.target.classList.add("hide"))};function initWebinarForm(t,r){if(t.webinarResultsArea){const a=t.webinarResultsArea;if(a){SafeQueryParams.set("page","1");const i={category:SafeQueryParams.get("category")?SafeQueryParams.get("category"):"",studylevel:SafeQueryParams.get("studylevel")?SafeQueryParams.get("studylevel"):"",region:SafeQueryParams.get("region")?SafeQueryParams.get("region"):"",view:SafeQueryParams.get("view")?SafeQueryParams.get("view"):"live",page:1};var e={page:i.page,params:{series:"",countries:i.region,subjects:"",studylevels:i.studylevel,faculties:"",categories:i.category,view:i.view},divider:"no"};main(t,a,r,e,"new"),""===a.innerHTML&&setDOMContent(a,"<p>No webinars found</p>"),stir.nodes("#webinarfilters select").forEach(e=>{e.value=i[e.name],e.addEventListener("change",handleFormChange(t,a,r))}),t.radioTabs.addEventListener("click",e=>{"INPUT"===e.target.nodeName&&handleRadioClick(t,a,r)(e)}),stir.nodes("#webinarfilters input").forEach(e=>{e.value===i[e.name]&&(e.checked=!0,e.closest("div").classList.add("u-bg-grey","u-energy-line-top"))}),a.addEventListener("click",handlePagination(t,a,r))}}}function initWebinarSections(t,r,a){var e,i;t.webinarSections.length&&((e=t.webinarSections).forEach(e=>{main(t,e,r,a[e.dataset.webinarsects],"onload")}),i=stir.node("[data-webinardisclaimer]"))&&e.map(e=>e.innerText).join("").trim().length<1&&setDOMContent(i,stir.t4Globals.webinarsdisclaimer||"")}!function(){if(stir.nodes("[data-webinar]")){const t={webinarResultsArea:stir.node("#webinarresults"),radioTabs:stir.node("#radioTabs"),webinarSections:stir.nodes("[data-webinarSects]"),itemsPerPage:6,safeList:["countries","series","subjects","studylevels","faculties","categories"],macros:(stir.t4Globals.regionmacros||[]).filter(e=>e.tag)};var e="dev"===UoS_env.name?"data.json":'<t4 type="navigation"  id="5271" />';const r=stir.t4Globals.webinarSectionData||{};fetch(e).then(e=>{if(e.ok)return e.json();throw new Error("Network response was not ok")}).then(e=>{return r="id",e.reduce((e,t)=>{return e.find(e=>e[r]===t[r])?e:[...e,t]},[]);var r}).catch(e=>(console.error("There was a problem fetching the webinar data:",e),[])).then(e=>{e=e,initWebinarForm(t,e),initWebinarSections(t,e,r)})}}();