!function(){function t(){var e,t="";for(e in i)i.hasOwnProperty(e)&&(t+=e+"="+i[e]+"&");stir.getJSON(s+t,y)}function r(e){var t=e.response.resultPacket.resultsSummary.totalMatching,r=i.start_rank+l-1;t<r&&(r=t),u.innerHTML=StirSearchHelpers.formSearchSummaryHTML(t,i.start_rank,r),n.innerHTML=d(e),c.innerHTML="",l<t&&(c.innerHTML=StirSearchHelpers.formPaginationHTML(t,l,o,m)),stir.scrollToElement(u,20)}function a(e){QueryParams.set("page",e),i.start_rank=(e-1)*l+1,t()}var s="https://www.stir.ac.uk/s/search.json?",n=document.querySelector("#news-search__results"),u=document.querySelector("#news-search__summary"),c=document.querySelector("#pagination-box"),e=document.querySelector("#news-search__form"),l=10,m=11,o=1,i={query:"!padre",collection:"stirling",meta_T:"[news gallery]",start_rank:1,num_ranks:l,sort:"date",fmo:"true",meta_d:""},y=function(e){e.error?(n.appendChild(stir.getMaintenanceMsg()),console.log(e)):null!=e.response.resultPacket&&0<e.response.resultPacket.results.length?r(e):(n.innerHTML="<p>No items found</p>",c.innerHTML="",u.innerHTML="")},d=function(e){var t,r="",a=e.response.resultPacket.results;for(t in a){var s,n,u,c=a[t];c.title&&(s=stir.String.getFirstFromSplit.call(c.title,"|"),n=(n=new Date(c.date)).getDate()+"/"+(n.getMonth()+1)+"/"+n.getFullYear(),null==(u=c.metaData.c)?u="":"."!=(u=c.metaData.c.split("|").pop().trim())[u.length-1]&&(u+="..."),r=(r=(r+='<div class="c-search-result">\t<div class="grid-x">    \t<div class="cell small-12 c-search-result">')+'        \t<p class="c-search-result__link"><a href="'+c.clickTrackingUrl+'">'+s+'</a></p>         \t<p class="c-search-result__breadcrumb">'+n+"</p>")+'         \t<p class="c-search-result__summary">'+u+"</p>    \t</div>    </div></div>")}return r};document.addEventListener("click",function(e){e.target.matches("#pagination-box a")&&(o=e.target.getAttribute("data-page"),a(o),e.preventDefault()),e.target.matches("#pagination-box a span")&&(o=e.target.parentNode.getAttribute("data-page"),a(o),e.preventDefault())},!1),e.addEventListener("submit",function(e){return""!==document.getElementById("news-search__query").value?(i.query=document.getElementById("news-search__query").value,QueryParams.set("keyword",document.getElementById("news-search__query").value)):(i.query="!padre",QueryParams.set("keyword","")),""!==document.getElementById("news-search__format").value&&(i.meta_T=document.getElementById("news-search__format").value,QueryParams.set("type",document.getElementById("news-search__format").value)),i.meta_d=document.getElementById("news-search__year").value,QueryParams.set("year",i.meta_d),o=1,QueryParams.set("page",o),i.start_rank=(o-1)*l+1,t(),e.preventDefault(),!1},!1),""!==QueryParams.get("keyword")&&void 0!==QueryParams.get("keyword")&&(document.getElementById("news-search__query").value=QueryParams.get("keyword"),i.query=QueryParams.get("keyword")),""!==QueryParams.get("type")&&void 0!==QueryParams.get("type")&&(i.meta_T=QueryParams.get("type"),document.getElementById("news-search__format").value=QueryParams.get("type")),isNaN(QueryParams.get("year"))||(i.meta_d=QueryParams.get("year"),document.getElementById("news-search__year").value=QueryParams.get("year")),isNaN(QueryParams.get("page"))||(o=QueryParams.get("page")),i.start_rank=(o-1)*l+1,t()}();