!function(){function t(){var e,t="";for(e in o)o.hasOwnProperty(e)&&(t+=e+"="+o[e]+"&");stir.getJSON(a+t,i)}function r(e){QueryParams.set("page",e),o.start_rank=(e-1)*l+1,t()}var a="https://www.stir.ac.uk/s/search.json?",s=document.querySelector("#news-search__results"),n=document.querySelector("#news-search__summary"),u=document.querySelector("#pagination-box"),e=document.querySelector("#news-search__form"),l=10,c=11,m=1,o={query:"!padre",collection:"stirling",meta_T:"[news gallery]",start_rank:1,num_ranks:l,sort:"date",fmo:"true",meta_d:""},i=function(e){if(e.error)s.appendChild(stir.getMaintenanceMsg()),console.log(e);else if(null!=e.response.resultPacket&&0<e.response.resultPacket.results.length){var t=e.response.resultPacket.resultsSummary.totalMatching,r=o.start_rank+l-1;if(r>t)r=t;if(n.innerHTML=StirSearchHelpers.formSearchSummaryHTML(t,o.start_rank,r),s.innerHTML=y(e),u.innerHTML="",l<t)u.innerHTML=StirSearchHelpers.formPaginationHTML(t,l,m,c);stir.scrollToElement(n,20)}else s.innerHTML="<p>No items found</p>",u.innerHTML="",n.innerHTML=""},y=function(e){var t,r="",a=e.response.resultPacket.results;for(t in a){var s,n,u,l=a[t];l.title&&(s=stir.String.getFirstFromSplit.call(l.title,"|"),n=(n=new Date(l.date)).getDate()+"/"+(n.getMonth()+1)+"/"+n.getFullYear(),null==(u=l.metaData.c)?u="":"."!=(u=l.metaData.c.split("|").pop().trim())[u.length-1]&&(u+="..."),r=(r=(r+='<div class="c-search-result">\t<div class="grid-x">    \t<div class="cell small-12 c-search-result">')+'        \t<p class="c-search-result__link"><a href="'+l.clickTrackingUrl+'">'+s+'</a></p>         \t<p class="c-search-result__breadcrumb">'+n+"</p>")+'         \t<p class="c-search-result__summary">'+u+"</p>    \t</div>    </div></div>")}return r};document.addEventListener("click",function(e){e.target.matches("#pagination-box a")&&(m=e.target.getAttribute("data-page"),r(m),e.preventDefault()),e.target.matches("#pagination-box a span")&&(m=e.target.parentNode.getAttribute("data-page"),r(m),e.preventDefault())},!1),e.addEventListener("submit",function(e){return""!==document.getElementById("news-search__query").value?(o.query=document.getElementById("news-search__query").value,QueryParams.set("keyword",document.getElementById("news-search__query").value)):(o.query="!padre",QueryParams.set("keyword","")),""!==document.getElementById("news-search__format").value&&(o.meta_T=document.getElementById("news-search__format").value,QueryParams.set("type",document.getElementById("news-search__format").value)),o.meta_d=document.getElementById("news-search__year").value,QueryParams.set("year",o.meta_d),m=1,QueryParams.set("page",m),o.start_rank=(m-1)*l+1,t(),e.preventDefault(),!1},!1),""!==QueryParams.get("keyword")&&void 0!==QueryParams.get("keyword")&&(document.getElementById("news-search__query").value=QueryParams.get("keyword"),o.query=QueryParams.get("keyword")),""!==QueryParams.get("type")&&void 0!==QueryParams.get("type")&&(o.meta_T=QueryParams.get("type"),document.getElementById("news-search__format").value=QueryParams.get("type")),isNaN(QueryParams.get("year"))||(o.meta_d=QueryParams.get("year"),document.getElementById("news-search__year").value=QueryParams.get("year")),isNaN(QueryParams.get("page"))||(m=QueryParams.get("page")),o.start_rank=(m-1)*l+1,t()}();