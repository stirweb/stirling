function initialize(){var e,g,c=new google.maps.Map(document.getElementById("map"),{zoom:4,center:new google.maps.LatLng(22.821757,57.041016),scrollwheel:!1,navigationControl:!1,mapTypeControl:!1,scaleControl:!1,draggable:!0,minZoom:3,mapTypeId:google.maps.MapTypeId.ROADMAP}),d=new google.maps.InfoWindow,m=new google.maps.LatLngBounds,h=[];switch(window.location.hostname){case"localhost":e="partners.xml";break;case"t4cms.stir.ac.uk":e="https://t4cms.stir.ac.uk/terminalfour/preview/1/en/3689";break;default:e="/data/our-partners/index.xml"}g="localhost"===window.location.hostname?"":"/webcomponents/",$.ajax({type:"GET",url:e,dataType:"xml",success:function(e){$(e).find("partner").each(function(e){var t,n=$(this).find("title").text(),a=$(this).find("location").text(),o=$(this).find("agreement").text(),s=$(this).find("url").text(),i=$(this).find("lat").text(),p=$(this).find("lng").text(),l=$(this).find("type").text(),r={teaching:g+"dist/images/markers/red_pin.png",research:g+"dist/images/markers/blue_pin.png",default:g+"dist/images/markers/red_pin.png"};i&&p&&((i=new google.maps.Marker({position:new google.maps.LatLng(i,p),map:c,icon:r[l]||r.default})).__meta_type=l,google.maps.event.addListener(i,"click",(t=i,function(){var e=[];"teaching"===l?s?e.push('<p><strong><a href="'+s+'">'+n+'</a></strong><br><span style="font-size: 16px">'+a+'</span><p style="font-size: 16px">'+o+"</p>"):e.push("<p><strong>"+n+'</strong><br><span style="font-size: 16px">'+a+'</span><p style="font-size: 16px">'+o+"</p>"):e.push("<p>"+n+"</p>"),d.setContent(e.join("")),d.open(c,t)})),m.extend(i.getPosition()),h.push(i))}),c.fitBounds(m)},error:function(){alert("Failed to get xml")}}),$(".c-full-width-map__legend input[type='checkbox']").on("change",function(e){for(var t=$(this).is(":checked"),n=$(this).data("type"),a=0;a<h.length;a++)n===h[a].__meta_type&&h[a].setMap(t?c:null)})}