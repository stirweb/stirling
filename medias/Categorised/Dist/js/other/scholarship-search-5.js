!function(){function o(){function t(t){return t.options[t.selectedIndex].value}var e={subjectType:p.options[p.selectedIndex].parentNode.label,subject:t(p),nation:t(d),studyLevel:t(g),feeStatus:t(y),faculty:"",sortBy:t(g).includes("Undergraduate")?"ugOrder":""};return t(g).includes("Postgraduate")&&(e.sortBy="pgOrder"),"Faculty"===e.subjectType&&(e.faculty=e.subject,e.subject="",e.sortBy="ugOrderFaculty",t(g).includes("Postgraduate")&&(e.sortBy="pgOrderFaculty")),"Postgraduate Taught"===e.studyLevel&&(e.studyLevel="Postgraduate (taught)"),"Postgraduate Research"===e.studyLevel&&(e.studyLevel="Postgraduate (research)"),"!padrenullquery"===e.subject&&(e.subject=""),e.subject=e.subject.toLowerCase(),e.subjectType||(e.subjectType=""),e}var e,a,r,s="localhost"==window.location.hostname,c=stir.t4Globals.eu||[],i=stir.t4Globals.commonwealth||[],l=stir.t4Globals.ssAfrica||[],u=[{id:"RUK",short:"RUK",long:"England, Wales, NI, Republic of Ireland"},{Id:"EU",short:"European",long:"European Union"}],d=stir.node("#scholarship-search__nationality"),p=stir.node("#scholarship-search__subject"),g=stir.node("#scholarship-search__level"),y=stir.node("#scholarship-search__feestatus"),n=stir.node("#scholarship-search__form"),f=stir.node("#scholarship-search__results"),t=stir.node("#scholarship-search__clear"),h=stir.nodes("[data-scholcountrylisting]"),b={postsPerPage:30,noPageLinks:9},v=stir.curry(function(t,e){if(e.title){var a={studyLevel:e.studyLevel||"",feeStatus:e.feeStatus||"",faculty:e.faculty||"",nationality:e.nationality||"",promotedSubject:e.promotedSubject?e.promotedSubject.toLowerCase():"",otherSubject:e.otherSubject?e.otherSubject.toLowerCase():""},n={cw:i.includes(t.nation)?"All Commonwealth":"!nofindyme",eu:c.includes(t.nation)?"All EU":"!nofindyme",ssa:l.includes(t.nation)?"All Sub-Saharan Africa":"!nofindyme"};if(m(a,t,n))return e.pos=P(t,a,e,n),e}}),m=function(t,e,a){e=[t.studyLevel.includes(e.studyLevel),t.feeStatus.includes(e.feeStatus),t.otherSubject.includes(e.subject.toLowerCase())||t.promotedSubject.includes(e.subject.toLowerCase()),t.faculty.includes(e.faculty)||t.faculty.includes("All Faculties"),t.nationality.includes(e.nation)||t.nationality.includes("All nationalities")||t.nationality.includes(a.cw)||t.nationality.includes(a.eu)||t.nationality.includes(a.ssa)];return stir.all(function(t){return t},e)},P=function(t,e,a,n){var r="1000";return""===t.sortBy&&(""!==a.ugOrder&&(r=a.ugOrder),""!==a.pgOrder&&(r=a.pgOrder)),"ugOrder"===t.sortBy&&(r=a.ugOrder),"pgOrder"===t.sortBy&&(r=a.pgOrder),"ugOrderFaculty"===t.sortBy&&(r=a.ugOrderFaculty),r=(r="pgOrderFaculty"===t.sortBy?a.pgOrderFaculty:r)||"1000",""!==t.nation&&e.nationality.includes(t.nation)&&(r=j(r,-1e4,e.nationality.indexOf(t.nation))),e.nationality!==n.cw&&e.nationality!==n.ssa&&e.nationality!==n.eu||(r=j(r,-100,0)),""!==t.subject&&e.promotedSubject.includes(t.subject.toLowerCase())&&(r=j(r,-2e4,0)),r=""!==t.faculty&&e.faculty.includes(t.faculty)?j(r,-2e4,0):r},j=function(t,e,a){return String(e+parseInt(t)+a)},O=stir.curry(function(t,e){return'\n        <p class="u-margin-bottom"> Displaying  '.concat(t.start+1," - ").concat(t.last,"  of  \n            <strong>").concat(t.totalPosts," results</strong> that match your criteria.</p>\n        ").concat(stir.map(function(t){return S(t)},e).join(""),' \n        <div class="grid-x grid-padding-x u-padding-top" id="pagination-box">\n            ').concat(L(t),"\n        </div> ")}),L=function(t){return t.postsPerPage>t.totalPosts?"":StirSearchHelpers.formPaginationHTML(t.totalPosts,t.postsPerPage,t.currentPage,t.noPageLinks)},S=function(t){var e,a,n=t.feeStatus||"";return stir.each(function(t){n=n.replace(t.short,t.long)},u),'\n        <div class="c-scholarship-search-result">\n            <div class="grid-x grid-padding-x">\n                <div class="cell small-12 medium-12 large-10">\n                <h3 class="c-section-heading u-heritage-green c-scholarship-search-result__title">\n                    <a href="'.concat(t.url,'">').concat(t.title,"</a></h3>\n                    <p>").concat(t.teaser,'</p> \n                </div>\n            </div>\n            <div class="grid-x grid-padding-x c-scholarship-search-result__details">\n            ').concat(_(n,"Fee status")," \n            ").concat(_((e=t.studyLevel,(a="desc")!=a?e.split(", ").sort().join(", "):"desc"==a?e.split(", ").sort().reverse().join(", "):void 0),"Level"),'\n            </div>\n            <div class="grid-x grid-padding-x">\n                <div class="cell small-12">\n                <a href="').concat(t.url,'" class="c-link" aria-label="View ').concat(t.title,'" >').concat(t.title,"</a>\n                ").concat(s&&t?x(t):"","\n                </div>\n            </div>\n        </div>")},_=function(t,e){return t?'\n        <div class="cell small-12 medium-5 large-5">\n          <div class="c-scholarship-search-result__detail">\n            <p class="u-font-bold">'.concat(e,"</p>\n            <p>").concat(t,"</p>\n          </div>\n        </div> "):""},x=function(t){return'\n        <div class="debug">\n          <h3>Debug</h3>\n          <b>Weighting: </b> '.concat(t.pos,"\n          <br><b>Nationalities (M):</b> ").concat(t.nationality,"\n          <br><b>Promoted (R):</b> ").concat(t.promotedSubject,"\n          <br><b>Other (Q):</b> ").concat(t.otherSubject,"\n          <br><b>Order (UG, PG):</b> ").concat(t.ugOrder,", ").concat(t.pgOrder,"\n          <br><b>Faculty:</b> ").concat(t.faculty,"\n          <br><b>Faculty Order (UG, PG):</b> ").concat(t.ugOrderFaculty," , ").concat(t.pgOrderFaculty,"</p>\n        </div>")},I=stir.curry(function(t,e){return t.innerHTML=e,t}),w=stir.jsonscholarships.scholarships||[];w.length&&(n&&f&&(e=function(t,e){var a=I(f),t=(t&&(d.value=QueryParams.get("nationality")||"",p.value=QueryParams.get("subject")||"!padrenullquery",g.value=QueryParams.get("level")||"",y.value=QueryParams.get("feestatus")||""),stir.filter(v(o()))),n=stir.sort(function(t,e){return parseInt(t.pos)<parseInt(e.pos)?-1:parseInt(t.pos)>parseInt(e.pos)?1:0}),n=stir.compose(n,t,stir.clone)(w),t={currentPage:e,totalPosts:n.length,start:(e-1)*b.postsPerPage,end:(e-1)*b.postsPerPage+b.postsPerPage},r=t.totalPosts<t.end?t.totalPosts:t.end,s=stir.Object.extend({},b,t,{last:r}),e=stir.filter(function(t,e){return e>=s.start&&e<r}),t=O(s);return stir.compose(a,t,e)(n)},n.addEventListener("submit",function(t){t.preventDefault();e(!1,1),stir.scrollToElement&&stir.scrollToElement(f,20);t={page:1,nationality:d.options[d.selectedIndex].value,subject:p.options[p.selectedIndex].value,level:g.options[g.selectedIndex].value,feestatus:y.options[y.selectedIndex].value};QueryParams.set(t)}),f.addEventListener("click",function(t){var e;t.target.matches("#pagination-box a")&&(e=t.target.getAttribute("data-page"),a(e),t.preventDefault()),t.target.matches("#pagination-box a span")&&(e=t.target.parentNode.getAttribute("data-page"),a(e),t.preventDefault())},!(a=function(t){QueryParams.set({page:t}),e(!1,t),stir.scrollToElement(n,-40)})),t&&(t.onclick=function(t){return QueryParams.set({page:1,nationality:"",subject:"!padrenullquery",level:"",feestatus:""}),e(!0,1),stir.scrollToElement(n,-40),t.preventDefault(),!1}),t=stir.isNumeric(QueryParams.get("page"))?QueryParams.get("page"):1,e(!0,t)),h&&(r=stir.curry(function(t){return"\n        <ul> \n        ".concat(stir.map(function(t){return'<li><a href="'.concat(t.url,'">').concat(t.title,"</a> ").concat(s?t.pos:"","</li>")},t).join("")," </ul>")}),h.forEach(function(t){var e=I(t),t=stir.filter(v({subject:"",subjectType:"",nation:t.dataset.country,studyLevel:t.dataset.studylevel,feeStatus:"",faculty:"",sortBy:t.dataset.studylevel.includes("Postgraduate")?"pgOrder":"ugOrder"})),a=stir.filter(function(t){return parseInt(t.pos)<1e3}),n=stir.sort(function(t,e){return parseInt(t.pos)<parseInt(e.pos)?-1:parseInt(t.pos)>parseInt(e.pos)?1:0});return stir.compose(e,r,a,n,t,stir.clone)(w)})))}();