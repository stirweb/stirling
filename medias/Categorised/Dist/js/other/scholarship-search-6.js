!function(){function r(t,e,n,r){return""!==e&&t.toLowerCase().includes(e.toLowerCase())?A(n,r,P(t,e)):n}function l(t,e){var n="Subject",r=w(N(t.inputNation));return{subjectType:n,subject:E(n,N(t.inputSubject)),nation:N(t.inputNation),studyLevel:D(N(t.inputLevel)),feeStatus:N(t.inputFeeStatus),faculty:q(n,N(t.inputSubject)),sortBy:T(n,N(t.inputLevel)),regions:stir.map(r,e)}}function e(t,e,n,r,s){t&&((t=n.nodes).inputNation.value=QueryParams.get("nationality")||"Any",t.inputSubject.value=QueryParams.get("subject")||"!padrenullquery",t.inputLevel.value=QueryParams.get("level")||"Any",t.inputFeeStatus.value=QueryParams.get("feestatus")||"Any");var t=(1===e?x:B)(n.nodes.resultsArea),a=stir.filter(v(n,l(n.nodes,n.regionmacros))),i=stir.map(b(l(n.nodes,n.regionmacros))),u=stir.sort(function(t,e){return parseInt(t.rank)<parseInt(e.rank)?-1:parseInt(t.rank)>parseInt(e.rank)?1:0}),u=stir.compose(u,i,a)(s),o=(i={currentPage:e,totalPosts:u.length,start:(e-1)*r.postsPerPage,end:(e-1)*r.postsPerPage+r.postsPerPage}).totalPosts<i.end?i.totalPosts:i.end,c=stir.Object.extend({},r,i,{last:o}),a=stir.filter(function(t,e){return e>=c.start&&e<o}),s=L(n,c);stir.compose(t,s,a)(u)}var t=stir.nodes("[data-scholcountrylisting]"),n=stir.nodes("[data-scholsubjectlisting]"),s="dev"==UoS_env.name||"qa"==UoS_env.name,a=(console.log(UoS_env),stir.node("#scholarship-search__nationality")),i=stir.node("#scholarship-search__subject"),u=stir.node("#scholarship-search__level"),o=stir.node("#scholarship-search__feestatus"),c=stir.node("#scholarship-search__form"),d=stir.node("#scholarship-search__results"),p=stir.node("#scholarship-search__clear"),f=stir.t4Globals||{},g=f.regionmacros||[],f=f.feeStatusesAll.feestatuses||[],h={debug:s,regions:{ukroi:stir.flatten(g.filter(function(t){return"UK and ROI"===t.tag}).map(function(t){return t.data}))},regionmacros:stir.filter(function(t){if(t.tag)return t},g)||[],feeStatusesAll:f,feeStatusAllSize:f.map(function(t){return t.name}).join(", ").split(", ").length,nodes:{inputNation:a,inputSubject:i,inputLevel:u,inputFeeStatus:o,searchForm:c,resultsArea:d,searchClearBtn:p}},y={postsPerPage:10,noPageLinks:9},v=stir.curry(function(t,e,n){if(n.title&&S(e,n,t))return n}),b=stir.curry(function(t,e){return{rank:O(t,e),scholarship:e}}),m=function(t,e,n){return!n.includes(e)&&t.includes("All international")},j=function(e,t){return!(!t||t.length)&&(t=t.map(function(t){return e.includes(t)}),stir.any(function(t){return t},t))},S=function(t,e,n){var r,s=[(s=e.studyLevel,"Any"===(r=t.studyLevel)||(console.log(s,r),s.includes(r))),(s=e.feeStatus,"Any"==(r=t.feeStatus)||"International"==r||"Any"==s||"International"==s||s.includes(r)),(s=e,"Any"===(r=t.subject)||s.otherSubject.toLowerCase().includes(r.toLowerCase())||s.promotedSubject.toLowerCase().includes(r.toLowerCase())),(s=e.faculty,r=t.faculty,s.includes(r)||s.includes("All Faculties")),(r=e.nationality,s=t.nation,t=t.regions,n=n.regions.ukroi,"Any"===s||r.includes(s)||r.includes("All nationalities")||m(r,s,n)||j(r,t))];return stir.all(function(t){return t},s)&&console.log(e.title),stir.all(function(t){return t},s)},P=function(t,e){return t.toLowerCase().indexOf(e.toLowerCase())},A=function(t,e,n){return String(e+parseInt(t)+n)},O=function(t,e){var n=function(t,e){if(""===e.sortBy){if(""!==t.ugOrder)return t.ugOrder;if(""!==t.pgOrder)return t.pgOrder}return"ugOrder"===e.sortBy?t.ugOrder:"pgOrder"===e.sortBy?t.pgOrder:"ugOrderFaculty"===e.sortBy?t.ugOrderFaculty:"pgOrderFaculty"===e.sortBy?t.pgOrderFaculty:"1000"}(e,t),n=stir.isNumeric(parseInt(n))?n:"1000",n=r(e.nationality,t.nation,n,-1e4),n=j(e.nationality,t.regions)?A(n,-100,0):n,n=r(e.promotedSubject,t.subject,n,-2e4);return r(e.faculty,t.faculty,n,-2e4)},L=stir.curry(function(e,t,n){return'\n        <p class="u-margin-bottom text-center"> Displaying  '.concat(t.start+1," - ").concat(t.last,"  of  <strong>").concat(t.totalPosts," results</strong> that match your criteria.</p>\n        ").concat(stir.map(function(t){return k(e,t)},n).join(""),' \n        <div class="grid-x grid-padding-x " id="pagination-box">\n          ').concat((n=t.currentPage,t.totalPosts<=t.last?"":'<div class="cell text-center">\n              <button class="button hollow tiny" data-page="'.concat(n,'">Load more results</button>\n        </div>')),"\n        </div> ")}),k=function(t,e){return'\n        <div class="u-margin-bottom u-bg-white u-p-2 u-heritage-green-line-left u-relative">\n            <div class="u-absolute u-top--15">\n            '.concat((n=e.scholarship.studyLevel,((r="desc")!==r?n.split(", ").sort():n.split(", ").sort().reverse()).map(I).join("")),'\n            </div>\n            <div class="grid-x grid-padding-x">\n                <div class="cell  u-mt-1">\n                    <p class="u-heritage-green u-mb-2">\n                      <strong><a href="').concat(e.scholarship.url,'">').concat(e.scholarship.title,'</a></strong></p>\n                    <p class="u-mb-2">').concat(e.scholarship.teaser,"</p> \n                </div>\n\n                ").concat(F(e.scholarship.value,"Value",!1),"\n                ").concat(F(e.scholarship.awards,"Number of awards",!0),"\n                ").concat(F(function(t,n){t=t.split(", ").map(function(e){var t=stir.filter(function(t){if(t.value===e)return t},n.feeStatusesAll);return t[0]?t[0].name:e});return t.join(", ").split(", ").length===n.feeStatusAllSize?"All fee statuses":t.join(", ")}(e.scholarship.feeStatus,t),"Fee status",!0),"\n              \n                ").concat(s&&e?_(e):"","\n            </div>\n        </div>");var n,r},I=function(t){return'<span class="u-bg-mint c-tag u-mr-1 ">'.concat(t,"</span>")},F=function(t,e,n){return t?'\n        <div class="cell small-12  large-4 '.concat(n?"u-grey-line-left u-no-border-medium":"",' ">\n          <div class="u-mb-fixed-1 u-h-full">\n            <p class="u-font-bold">').concat(e,'</p>\n            <p class="u-m-0">').concat(t,"</p>\n          </div>\n        </div> "):""},_=function(t){return'\n        <div class="cell u-mt-2 u-p-2 u-border-solid " >\n          <h3>Debugger</h3>\n          <b>Weighting: </b> '.concat(t.rank,"\n          <br><b>Nationalities (M):</b> ").concat(t.scholarship.nationality,"\n          <br><b>Fee Status (M):</b> ").concat(t.scholarship.feeStatus,"\n          <br><b>Promoted (R):</b> ").concat(t.scholarship.promotedSubject,"\n          <br><b>Other (Q):</b> ").concat(t.scholarship.otherSubject,"\n          <br><b>Order (UG, PG):</b> ").concat(t.scholarship.ugOrder,", ").concat(t.scholarship.pgOrder,"\n          <br><b>Faculty:</b> ").concat(t.scholarship.faculty,"\n          <br><b>Faculty Order (UG, PG):</b> ").concat(t.scholarship.ugOrderFaculty," , ").concat(t.scholarship.pgOrderFaculty,"</p>\n        </div> ")},x=stir.curry(function(t,e){return t.innerHTML=e,t}),B=stir.curry(function(t,e){return t.insertAdjacentHTML("beforeend",e),t}),w=stir.curry(function(t,e){return e.data.includes(t)?e.tag:"!No findy me!"}),N=function(t){return t.options[t.selectedIndex].value||"Any"},T=function(t,e){if(!e)return"";if("Faculty"===t){if(e.includes("Undergraduate"))return"ugOrderFaculty";if(e.includes("Postgraduate"))return"pgOrderFaculty"}return e.includes("Undergraduate")?"ugOrder":e.includes("Postgraduate")?"pgOrder":void 0},E=function(t,e){return e?"Faculty"===t||"!padrenullquery"===e?"":e.toLowerCase():"Any"},q=function(t,e){return e?"Subject"===t||"!padrenullquery"===e?"":e:"Any"},D=function(t){return t?"Postgraduate Taught"===t?"Postgraduate (taught)":"Postgraduate Research"===t?"Postgraduate (research)":t:"Any"};if(c&&d){var C=stir.jsonscholarships.scholarships||[];if(!C.length)return;c.addEventListener("submit",function(t){t.preventDefault();e(!1,1,h,y,C),stir.scrollToElement&&stir.scrollToElement(d,20);t={page:1,nationality:a.options[a.selectedIndex].value,subject:i.options[i.selectedIndex].value,level:u.options[u.selectedIndex].value,feestatus:o.options[o.selectedIndex].value};QueryParams.set(t)});d.addEventListener("click",function(t){t.target.matches("#pagination-box button")&&(t.target.classList.add("hide"),t=Number(t.target.getAttribute("data-page"))+1,QueryParams.set({page:t}),e(!1,t,h,y,C))},!1),p&&(p.onclick=function(t){return QueryParams.set({page:1,nationality:"Any",subject:"!padrenullquery",level:"Any",feestatus:"Any"}),e(!0,1,h,y,C),stir.scrollToElement(c,-40),t.preventDefault(),!1});g=stir.isNumeric(QueryParams.get("page"))?QueryParams.get("page"):1;e(!0,g,h,y,C)}function G(r,s,a){return s.dataset.country.split(", ").map(function(t){t=t,e=r.regionmacros;var t={subject:"Any",subjectType:"",nation:t,studyLevel:s.dataset.studylevel,feeStatus:"Any",faculty:"Any",sortBy:s.dataset.studylevel.includes("Postgraduate")?"pgOrder":"ugOrder",regions:stir.map(w(t),e)},e=stir.filter(v(r,t)),t=stir.map(b(t)),n=stir.filter(function(t){return parseInt(t.rank)<1e3});return stir.compose(n,t,e)(a)})}var Q=stir.curry(function(t){return stir.map(function(t){return'<li data-rank="'.concat(t.rank,'"><a href="').concat(t.scholarship.url,'">').concat(t.scholarship.title,"</a> ").concat(s?t.rank:"","</li>")},t)}),U=stir.curry(function(t){return"<ul> ".concat(t.join("\n"),"</ul>")}),f={dev:"data.json",qa:"data.json",preview:"https://stiracuk-cms01-production.terminalfour.net/terminalfour/preview/1/en/29339/",prod:"/data/scholarships/json/index.json"};t.length&&stir.getJSON(f[UoS_env.name],function(r){r.length&&t.forEach(function(t){var e=x(t),n=stir.sort(function(t,e){return parseInt(t.rank)<parseInt(e.rank)?-1:parseInt(t.rank)>parseInt(e.rank)?1:0});return stir.compose(e,U,stir.removeDuplicates,Q,n)(stir.flatten(G(h,t,r)))})});n.length&&stir.getJSON(f[UoS_env.name],function(a){a.length&&n.forEach(function(t){var e={subject:t.dataset.subject,subjectType:"Subject",nation:"Any",studyLevel:t.dataset.studylevel,feeStatus:"Any",faculty:"Any",sortBy:t.dataset.studylevel.includes("Postgraduate")?"pgOrder":"ugOrder",regions:[]},n=stir.filter(v(h,e)),e=stir.map(b(e)),r=stir.sort(function(t,e){return parseInt(t.rank)<parseInt(e.rank)?-1:parseInt(t.rank)>parseInt(e.rank)?1:0}),t=x(t),s=stir.filter(function(t,e){return e<5});return stir.compose(t,U,Q,s,r,e,n)(a)})})}();