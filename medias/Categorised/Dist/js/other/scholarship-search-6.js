!function(){const e=stir.nodes("[data-scholcountrylisting]"),t=stir.nodes("[data-scholsubjectlisting]"),n=!!stir.node("[data-debug]"),r=stir.node("#scholarship-search__nationality"),s=stir.node("#scholarship-search__subject"),a=stir.node("#scholarship-search__level"),i=stir.node("#scholarship-search__feestatus"),u=stir.node("#scholarship-search__form"),l=stir.node("#scholarship-search__results");var o=stir.node("#scholarship-search__clear"),c=stir.t4Globals||{},d=c.regionmacros||[],c=c.feeStatusesAll.feestatuses||[];const p={debug:n,regions:{ukroi:stir.flatten(d.filter(e=>"UK and ROI"===e.tag).map(e=>e.data))},regionmacros:stir.filter(e=>{if(e.tag)return e},d)||[],feeStatusesAll:c,feeStatusAllSize:c.map(e=>e.name).join(", ").split(", ").length,nodes:{inputNation:r,inputSubject:s,inputLevel:a,inputFeeStatus:i,searchForm:u,resultsArea:l,searchClearBtn:o}},g={postsPerPage:10,noPageLinks:9},h=stir.curry((e,t,r)=>{if(r.title&&m(t,r,e))return r}),y=stir.curry((e,t)=>{return{rank:P(e,t),scholarship:t}}),b=(e,t,r)=>!r.includes(t)&&e.includes("All international"),f=(t,e)=>{return!(!e||!e.length)&&(e=e.map(e=>t.includes(e)),stir.any(e=>e,e))},m=(e,t,r)=>{var s,a,r=[(s=t.studyLevel,"Any"===(a=e.studyLevel)||s.includes(a)),(s=t.feeStatus,"Any"==(a=e.feeStatus)||s.includes(a)),(s=t,"Any"===(a=e.subject)||s.otherSubject.toLowerCase().includes(a.toLowerCase())||s.promotedSubject.toLowerCase().includes(a.toLowerCase())),(t.faculty,e.faculty,!0),(s=t.nationality,a=e.nation,t=e.regions,e=r.regions.ukroi,"Any"===a||s.includes(a)||s.includes("All nationalities")||b(s,a,e)||f(s,t))];return stir.all(e=>e,r)},v=(e,t)=>e.toLowerCase().indexOf(t.toLowerCase()),S=(e,t,r,s)=>""!==t&&e.toLowerCase().includes(t.toLowerCase())?j(r,s,v(e,t)):r,j=(e,t,r)=>String(t+parseInt(e)+r),P=(e,t)=>{var r=((e,t)=>{if(!t.sortBy||""===t.sortBy){if(""!==e.ugOrder)return e.ugOrder;if(""!==e.pgOrder)return e.pgOrder}return"ugOrder"===t.sortBy?e.ugOrder:"pgOrder"===t.sortBy?e.pgOrder:"ugOrderFaculty"===t.sortBy?e.ugOrderFaculty:"pgOrderFaculty"===t.sortBy?e.pgOrderFaculty:"1000"})(t,e),r=stir.isNumeric(parseInt(r))?r:"1000",r=S(t.nationality,e.nation,r,-1e4),r=f(t.nationality,e.regions)?j(r,-100,0):r,r=S(t.promotedSubject,e.subject,r,-2e4);return S(t.feeStatus,e.feeStatus,r,-1010)},A=(r,e)=>e.split(", ").map(t=>{var e=stir.filter(e=>{if(e.value===t)return e},r);return e[0]?e[0].name:t}),O=stir.curry((t,r,e)=>{return`
        <p class="u-margin-bottom text-center"> Displaying  ${r.start+1} - ${r.last}  of  <strong>${r.totalPosts} results</strong> that match your criteria.</p>
        ${stir.map(e=>$(t,r,e),e).join("")} 
        <div class="grid-x grid-padding-x " id="pagination-box">
          ${{currentPage:e,totalPosts:s,last:a}=[r][0],s<=a?"":`<div class="cell text-center">
              <button class="button hollow tiny" data-page="${e}">Load more results</button>
        </div>`}
        </div> `;var s,a}),$=(e,t,r)=>{return`
        <div class="u-margin-bottom u-bg-white u-p-2 u-heritage-line-left u-border-width-5 u-relative">
            <div class="u-absolute u-top--16">
            ${s=r.scholarship.studyLevel,a="desc",("desc"!==a?s.split(", ").sort():s.split(", ").sort().reverse()).map(Q).join("")}
            </div>
            <div class="grid-x grid-padding-x">
                <div class="cell  u-mt-1">
                    <p class="u-heritage-green u-mb-2">
                      <strong><a href="${r.scholarship.url}">${r.scholarship.title}</a></strong></p>
                    <p class="u-mb-2">${r.scholarship.teaser}</p> 
                </div>

                ${L(r.scholarship.value,"Value",!1)}
                ${L(r.scholarship.awards,"Number of awards",!0)}
                ${L(((e,t,r)=>{e=A(t.feeStatusesAll,e),A(t.feeStatusesAll,r),r=e.join(", ");return e.join(", ").split(", ").length===t.feeStatusAllSize?"All fee statuses":r})(r.scholarship.feeStatus,e,t.feeStatusFilter)+" ","Fee status",!0)}
              
                ${n&&r?T(r):""}
            </div>
        </div>`;var s,a},Q=e=>`<span class="u-bg-heritage-green--10 c-tag u-mr-1 ">${e}</span>`,L=(e,t,r)=>e?`
        <div class="cell small-12  large-4 ${r?"u-grey-line-left u-no-border-medium":""} ">
          <div class="u-mb-fixed-1 u-h-full">
            <p class="u-font-bold">${t}</p>
            <p class="u-m-0">${e}</p>
          </div>
        </div> `:"",T=e=>`
        <div class="cell u-mt-2 u-p-2 u-border-solid " >
          <h3>Debugger</h3>
          <b>Weighting: </b> ${e.rank}
          <br><b>Nationalities (M):</b> ${e.scholarship.nationality}
          <br><b>Fee Status (M):</b> ${e.scholarship.feeStatus}
          <br><b>Promoted (R):</b> ${e.scholarship.promotedSubject}
          <br><b>Other (Q):</b> ${e.scholarship.otherSubject}
          <br><b>Order (UG, PG):</b> ${e.scholarship.ugOrder}, ${e.scholarship.pgOrder}
          <br><b>Faculty:</b> ${e.scholarship.faculty}
          <br><b>Faculty Order (UG, PG):</b> ${e.scholarship.ugOrderFaculty} , ${e.scholarship.pgOrderFaculty}</p>
        </div> `,k=stir.curry((e,t)=>(e.innerHTML=t,e)),E=stir.curry((e,t)=>(e.insertAdjacentHTML("beforeend",t),e)),I=stir.curry((e,t)=>t.data.includes(e)?t.tag:"!No findy me!"),F=e=>e.options[e.selectedIndex].value||"Any",U=(e,t)=>{if(!t)return"";if("Faculty"===e){if(t.includes("Undergraduate"))return"ugOrderFaculty";if(t.includes("Postgraduate"))return"pgOrderFaculty"}return t.includes("Undergraduate")?"ugOrder":t.includes("Postgraduate")?"pgOrder":void 0},q=(e,t)=>t?"Faculty"===e||"!padrenullquery"===t?"":t.toLowerCase():"Any",D=(e,t)=>t?"Subject"===e||"!padrenullquery"===t?"":t:"Any",G=e=>e?"Postgraduate Taught"===e?"Postgraduate (taught)":"Postgraduate Research"===e?"Postgraduate (research)":e:"Any",x=(e,t)=>{var r="Subject",s=I(F(e.inputNation));return{subjectType:r,subject:q(r,F(e.inputSubject)),nation:F(e.inputNation),studyLevel:G(F(e.inputLevel)),feeStatus:F(e.inputFeeStatus),faculty:D(r,F(e.inputSubject)),sortBy:U(r,F(e.inputLevel)),regions:stir.map(s,t)}},w=(e,t,r,s,a)=>{e&&((e=r.nodes).inputNation.value=QueryParams.get("nationality")||"Any",e.inputSubject.value=QueryParams.get("subject")||"!padrenullquery",e.inputLevel.value=QueryParams.get("level")||"Any",e.inputFeeStatus.value=QueryParams.get("feestatus")||"Any");var e=(1===t?k:E)(r.nodes.resultsArea),n=stir.filter(h(r,x(r.nodes,r.regionmacros))),i=stir.map(y(x(r.nodes,r.regionmacros))),u=stir.sort((e,t)=>parseInt(e.rank)<parseInt(t.rank)?-1:parseInt(e.rank)>parseInt(t.rank)?1:0),u=stir.compose(u,i,n)(a),i={currentPage:t,totalPosts:u.length,start:(t-1)*s.postsPerPage,end:(t-1)*s.postsPerPage+s.postsPerPage,feeStatusFilter:x(r.nodes,r.regionmacros).feeStatus};const l=i.totalPosts<i.end?i.totalPosts:i.end,o=stir.Object.extend({},s,i,{last:l});n=stir.filter((e,t)=>t>=o.start&&t<l),a=O(r,o);return stir.compose(e,a,n)(u)};if(u&&l){const C=stir.jsonscholarships.scholarships||[];if(!C.length)return;u.addEventListener("submit",e=>{e.preventDefault();w(!1,1,p,g,C),stir.scrollToElement&&stir.scrollToElement(l,20);e={page:1,nationality:r.options[r.selectedIndex].value,subject:s.options[s.selectedIndex].value,level:a.options[a.selectedIndex].value,feestatus:i.options[i.selectedIndex].value};QueryParams.set(e)});l.addEventListener("click",e=>{e.target.matches("#pagination-box button")&&(e.target.classList.add("hide"),e=Number(e.target.getAttribute("data-page"))+1,QueryParams.set({page:e}),w(!1,e,p,g,C))},!1),o&&(o.onclick=e=>{return QueryParams.set({page:1,nationality:"Any",subject:"!padrenullquery",level:"Any",feestatus:"Any"}),w(!0,1,p,g,C),stir.scrollToElement(u,-40),e.preventDefault(),!1});d=stir.isNumeric(QueryParams.get("page"))?QueryParams.get("page"):1;w(!0,d,p,g,C)}const _=stir.curry(e=>stir.map(e=>`<li ><a href="${e.scholarship.url}">${e.scholarship.title}</a> ${n?e.rank:""}</li>`,e)),N=stir.curry(e=>`<ul> ${e.join("\n")}</ul>`);c={dev:"data.json",qa:"data.json",preview:"https://stiracuk-cms01-production.terminalfour.net/terminalfour/preview/1/en/29339/",prod:"/data/scholarships/json/index.json"};const B=(s,a,n)=>a.dataset.country.split(", ").map(e=>{e=e,t=s.regionmacros;var e={subject:"Any",subjectType:"",nation:e,studyLevel:a.dataset.studylevel,feeStatus:"Any",faculty:"Any",sortBy:a.dataset.studylevel.includes("Postgraduate")?"pgOrder":"ugOrder",regions:stir.map(I(e),t)},t=stir.filter(h(s,e)),e=stir.map(y(e)),r=stir.filter(e=>parseInt(e.rank)<1e3);return stir.compose(r,e,t)(n)});e.length&&stir.getJSON(c[UoS_env.name],s=>{s.length&&e.forEach(e=>{var t=k(e),r=stir.sort((e,t)=>parseInt(e.rank)<parseInt(t.rank)?-1:parseInt(e.rank)>parseInt(t.rank)?1:0);return console.log(stir.compose(_,r)(stir.flatten(B(p,e,s)))),stir.compose(t,N,stir.removeDuplicates,_,r)(stir.flatten(B(p,e,s)))})});t.length&&stir.getJSON(c[UoS_env.name],n=>{n.length&&t.forEach(e=>{var t={subject:e.dataset.subject,subjectType:"Subject",nation:"Any",studyLevel:e.dataset.studylevel,feeStatus:"Any",faculty:"Any",sortBy:e.dataset.studylevel.includes("Postgraduate")?"pgOrder":"ugOrder",regions:[]},r=stir.filter(h(p,t)),t=stir.map(y(t)),s=stir.sort((e,t)=>parseInt(e.rank)<parseInt(t.rank)?-1:parseInt(e.rank)>parseInt(t.rank)?1:0),e=k(e),a=stir.filter((e,t)=>t<5);return stir.compose(e,N,_,a,s,t,r)(n)})})}();