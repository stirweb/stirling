!function(){const e=stir.nodes("[data-scholcountrylisting]"),t=stir.nodes("[data-scholsubjectlisting]"),n=!!stir.node("[data-debug]"),r=stir.node("#scholarship-search__nationality"),s=stir.node("#scholarship-search__subject"),a=stir.node("#scholarship-search__level"),i=stir.node("#scholarship-search__feestatus"),o=stir.node("#scholarship-search__form"),l=stir.node("#scholarship-search__results");var u=stir.node("#scholarship-search__clear"),d=stir.t4Globals||{},c=d.regionmacros||[],d=d.feeStatusesAll.feestatuses||[];const p={cookieType:"scholarship",showUrlToFavs:"true",debug:n,regions:{ukroi:stir.flatten(c.filter(e=>"UK and ROI"===e.tag).map(e=>e.data))},regionmacros:stir.filter(e=>{if(e.tag)return e},c)||[],feeStatusesAll:d,feeStatusAllSize:d.map(e=>e.name).join(", ").split(", ").length,nodes:{inputNation:r,inputSubject:s,inputLevel:a,inputFeeStatus:i,searchForm:o,resultsArea:l,searchClearBtn:u}},g={postsPerPage:10,noPageLinks:9},h=stir.curry((e,t,r)=>{if(r.title&&b(t,r,e))return r}),y=stir.curry((e,t)=>{return{rank:P(e,t),scholarship:t}}),v=(e,t,r)=>!r.includes(t)&&e.includes("All international"),f=(t,e)=>{return!(!e||!e.length)&&(e=e.map(e=>t.includes(e)),stir.any(e=>e,e))},b=(e,t,r)=>{var s,a,r=[(s=t.studyLevel,"Any"===(a=e.studyLevel)||s.includes(a)),(s=t.feeStatus,"Any"==(a=e.feeStatus)||s.includes(a)),(s=t,"Any"===(a=e.subject)||s.otherSubject.toLowerCase().includes(a.toLowerCase())||s.promotedSubject.toLowerCase().includes(a.toLowerCase())),(t.faculty,e.faculty,!0),(s=t.nationality,a=e.nation,t=e.regions,e=r.regions.ukroi,"Any"===a||s.includes(a)||s.includes("All nationalities")||v(s,a,e)||f(s,t))];return stir.all(e=>e,r)},m=(e,t)=>e.toLowerCase().indexOf(t.toLowerCase()),S=(e,t,r,s)=>""!==t&&e.toLowerCase().includes(t.toLowerCase())?j(r,s,m(e,t)):r,j=(e,t,r)=>String(t+parseInt(e)+r),P=(e,t)=>{var r=((e,t)=>{if(!t.sortBy||""===t.sortBy){if(""!==e.ugOrder)return e.ugOrder;if(""!==e.pgOrder)return e.pgOrder}return"ugOrder"===t.sortBy?e.ugOrder:"pgOrder"===t.sortBy?e.pgOrder:"ugOrderFaculty"===t.sortBy?e.ugOrderFaculty:"pgOrderFaculty"===t.sortBy?e.pgOrderFaculty:"1000"})(t,e),r=stir.isNumeric(parseInt(r))?r:"1000",r=S(t.nationality,e.nation,r,-1e4),r=f(t.nationality,e.regions)?j(r,-100,0):r,r=S(t.promotedSubject,e.subject,r,-2e4);return S(t.feeStatus,e.feeStatus,r,-1010)},A=(r,e)=>e.split(", ").map(t=>{var e=stir.filter(e=>{if(e.value===t)return e},r);return e[0]?e[0].name:t}),$=stir.curry((t,r,e)=>{return`
        <p class="u-margin-bottom text-center"> Displaying  ${r.start+1} - ${r.last}  of  <strong>${r.totalPosts} results</strong> that match your criteria.</p>
        ${stir.map(e=>F(t,r,e),e).join("")} 
        <div class="grid-x " id="pagination-box">
          ${{currentPage:e,totalPosts:s,last:a}=[r][0],s<=a?"":`<div class="cell text-center">
              <button class="button hollow tiny" data-page="${e}">Load more results</button>
        </div>`}
        </div> `;var s,a}),O=(e,t,r)=>t.length?stir.favourites.renderRemoveBtn(r,t[0].date,e):stir.favourites.renderAddBtn(r,e),F=(e,t,r)=>{var s,a,i=stir.favourites.getFav(r.scholarship.id,e.cookieType);return console.log(i),`
        <div class="u-margin-bottom u-bg-white u-p-2 u-heritage-line-left u-border-width-5 u-relative">
            <div class="u-absolute u-top--16">
            ${s=r.scholarship.studyLevel,a="desc",("desc"!==a?s.split(", ").sort():s.split(", ").sort().reverse()).map(C).join("")}
            </div>
            <div class="grid-x ">
                <div class="cell  u-mt-1">
                    <p class="u-heritage-green u-mb-2">
                      <strong><a href="${r.scholarship.url}">${r.scholarship.title}</a></strong></p>
                    <p class="u-mb-2">${r.scholarship.teaser}</p> 
                </div>

                ${k(r.scholarship.value,"Value",!1)}
                ${k(r.scholarship.awards,"Number of awards",!0)}
                ${k(((e,t,r)=>{e=A(t.feeStatusesAll,e),A(t.feeStatusesAll,r),r=e.join(", ");return e.join(", ").split(", ").length===t.feeStatusAllSize?"All fee statuses":r})(r.scholarship.feeStatus,e,t.feeStatusFilter)+" ","Fee status",!0)}
              
                ${n&&r?Q(r):""}
            <div class="cell text-sm u-pt-2" id="favbtns${r.scholarship.id}">
              ${O(e.showUrlToFavs,i,r.scholarship.id)}
            </div>
            </div>
        </div>`},C=e=>`<span class="u-bg-heritage-green--10 c-tag u-mr-1 ">${e}</span>`,k=(e,t,r)=>e?`
        <div class="cell small-12  large-4 ${r?"u-grey-line-left u-no-border-medium":""} ">
          <div class="u-mb-fixed-1 u-h-full">
            <p class="u-font-bold">${t}</p>
            <p class="u-m-0">${e}</p>
          </div>
        </div> `:"",Q=e=>`
        <div class="cell u-mt-2 u-p-2 u-border-solid " >
          <h3>Debugger</h3>
          <b>Weighting: </b> ${e.rank}
          <br><b>Nationalities (M):</b> ${e.scholarship.nationality}
          <br><b>Fee Status (M):</b> ${e.scholarship.feeStatus}
          <br><b>Promoted (R):</b> ${e.scholarship.promotedSubject}
          <br><b>Other (Q):</b> ${e.scholarship.otherSubject}
          <br><b>Order (UG, PG):</b> ${e.scholarship.ugOrder}, ${e.scholarship.pgOrder}
          <br><b>Faculty:</b> ${e.scholarship.faculty}
          <br><b>Faculty Order (UG, PG):</b> ${e.scholarship.ugOrderFaculty} , ${e.scholarship.pgOrderFaculty}</p>
        </div> `,L=stir.curry((e,t)=>(e.innerHTML=t,e)),U=stir.curry((e,t)=>(e.insertAdjacentHTML("beforeend",t),e)),I=stir.curry((e,t)=>t.data.includes(e)?t.tag:"!No findy me!"),w=e=>e.options[e.selectedIndex].value||"Any",E=(e,t)=>{if(!t)return"";if("Faculty"===e){if(t.includes("Undergraduate"))return"ugOrderFaculty";if(t.includes("Postgraduate"))return"pgOrderFaculty"}return t.includes("Undergraduate")?"ugOrder":t.includes("Postgraduate")?"pgOrder":void 0},q=(e,t)=>t?"Faculty"===e||"!padrenullquery"===t?"":t.toLowerCase():"Any",D=(e,t)=>t?"Subject"===e||"!padrenullquery"===t?"":t:"Any",G=e=>e?"Postgraduate Taught"===e?"Postgraduate (taught)":"Postgraduate Research"===e?"Postgraduate (research)":e:"Any",T=(e,t)=>{var r="Subject",s=I(w(e.inputNation));return{subjectType:r,subject:q(r,w(e.inputSubject)),nation:w(e.inputNation),studyLevel:G(w(e.inputLevel)),feeStatus:w(e.inputFeeStatus),faculty:D(r,w(e.inputSubject)),sortBy:E(r,w(e.inputLevel)),regions:stir.map(s,t)}},x=(e,t,r,s,a)=>{e&&((e=r.nodes).inputNation.value=QueryParams.get("nationality")||"Any",e.inputSubject.value=QueryParams.get("subject")||"!padrenullquery",e.inputLevel.value=QueryParams.get("level")||"Any",e.inputFeeStatus.value=QueryParams.get("feestatus")||"Any");var e=(1===t?L:U)(r.nodes.resultsArea),i=stir.filter(h(r,T(r.nodes,r.regionmacros))),n=stir.map(y(T(r.nodes,r.regionmacros))),o=stir.sort((e,t)=>parseInt(e.rank)<parseInt(t.rank)?-1:parseInt(e.rank)>parseInt(t.rank)?1:0),o=stir.compose(o,n,i)(a),n={currentPage:t,totalPosts:o.length,start:(t-1)*s.postsPerPage,end:(t-1)*s.postsPerPage+s.postsPerPage,feeStatusFilter:T(r.nodes,r.regionmacros).feeStatus};const l=n.totalPosts<n.end?n.totalPosts:n.end,u=stir.Object.extend({},s,n,{last:l});var d,i=stir.filter((e,t)=>t>=u.start&&t<l),a=$(r,u);stir.compose(e,a,i)(o),r.nodes.resultsArea.addEventListener("click",(d=r,e=>{var t,e=e.target.closest("button");e&&e.dataset&&e.dataset.action&&(t=e=>{var t=stir.favourites.getFav(e,d.cookieType),r=stir.node("#favbtns"+e);r&&L(r)(O(d.showUrlToFavs,t,e))},"addtofavs"===e.dataset.action&&(stir.favourites.addToFavs(e.dataset.id,d.cookieType),t(e.dataset.id)),"removefav"===e.dataset.action)&&(stir.favourites.removeFromFavs(e.dataset.id),t(e.dataset.id),"managefavs"===d.activity)&&(t=stir.node("#fav-"+e.dataset.id))&&L(t)("")}))};if(o&&l){const N=stir.jsonscholarships.scholarships||[];if(!N.length)return;o.addEventListener("submit",e=>{e.preventDefault();x(!1,1,p,g,N),stir.scrollToElement&&stir.scrollToElement(l,20);e={page:1,nationality:r.options[r.selectedIndex].value,subject:s.options[s.selectedIndex].value,level:a.options[a.selectedIndex].value,feestatus:i.options[i.selectedIndex].value};QueryParams.set(e)});l.addEventListener("click",e=>{e.target.matches("#pagination-box button")&&(e.target.classList.add("hide"),e=Number(e.target.getAttribute("data-page"))+1,QueryParams.set({page:e}),x(!1,e,p,g,N))},!1),u&&(u.onclick=e=>{return QueryParams.set({page:1,nationality:"Any",subject:"!padrenullquery",level:"Any",feestatus:"Any"}),x(!0,1,p,g,N),stir.scrollToElement(o,-40),e.preventDefault(),!1});c=stir.isNumeric(QueryParams.get("page"))?QueryParams.get("page"):1;x(!0,c,p,g,N)}const _=stir.curry(e=>stir.map(e=>`<li ><a href="${e.scholarship.url}">${e.scholarship.title}</a> ${n?e.rank:""}</li>`,e)),B=stir.curry(e=>`<ul> ${e.join("\n")}</ul>`);d={dev:"data.json",qa:"data.json",preview:"https://stiracuk-cms01-production.terminalfour.net/terminalfour/preview/1/en/29339/",prod:"/data/scholarships/json/index.json"};const M=(s,a,i)=>a.dataset.country.split(", ").map(e=>{e=e,t=s.regionmacros;var e={subject:"Any",subjectType:"",nation:e,studyLevel:a.dataset.studylevel,feeStatus:"Any",faculty:"Any",sortBy:a.dataset.studylevel.includes("Postgraduate")?"pgOrder":"ugOrder",regions:stir.map(I(e),t)},t=stir.filter(h(s,e)),e=stir.map(y(e)),r=stir.filter(e=>parseInt(e.rank)<1e3);return stir.compose(r,e,t)(i)});e.length&&stir.getJSON(d[UoS_env.name],s=>{s.length&&e.forEach(e=>{var t=L(e),r=stir.sort((e,t)=>parseInt(e.rank)<parseInt(t.rank)?-1:parseInt(e.rank)>parseInt(t.rank)?1:0);return stir.compose(t,B,stir.removeDuplicates,_,r)(stir.flatten(M(p,e,s)))})});t.length&&stir.getJSON(d[UoS_env.name],i=>{i.length&&t.forEach(e=>{var t={subject:e.dataset.subject,subjectType:"Subject",nation:"Any",studyLevel:e.dataset.studylevel,feeStatus:"Any",faculty:"Any",sortBy:e.dataset.studylevel.includes("Postgraduate")?"pgOrder":"ugOrder",regions:[]},r=stir.filter(h(p,t)),t=stir.map(y(t)),s=stir.sort((e,t)=>parseInt(e.rank)<parseInt(t.rank)?-1:parseInt(e.rank)>parseInt(t.rank)?1:0),e=L(e),a=stir.filter((e,t)=>t<5);return stir.compose(e,B,_,a,s,t,r)(i)})})}();