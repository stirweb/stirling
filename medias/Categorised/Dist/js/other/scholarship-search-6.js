!function(){function n(t,e,r,n){return""!==e&&t.toLowerCase().includes(e.toLowerCase())?S(r,n,j(t,e)):r}function l(t,e){var r=q(t.inputSubject.options[t.inputSubject.selectedIndex].parentNode.label),n=_(N(t.inputNation));return{subjectType:r,subject:U(r,N(t.inputSubject)),nation:N(t.inputNation),studyLevel:D(N(t.inputLevel)),feeStatus:N(t.inputFeeStatus),faculty:A(r,N(t.inputSubject)),sortBy:B(r,N(t.inputLevel)),regions:stir.map(n,e)}}function e(t,e,r,n,a){t&&((t=r.nodes).inputNation.value=QueryParams.get("nationality")||"",t.inputSubject.value=QueryParams.get("subject")||"!padrenullquery",t.inputLevel.value=QueryParams.get("level")||"",t.inputFeeStatus.value=QueryParams.get("feestatus")||"");var t=x(r.nodes.resultsArea),s=stir.filter(y(r,l(r.nodes,r.regionmacros))),i=stir.map(m(l(r.nodes,r.regionmacros))),o=stir.sort(function(t,e){return parseInt(t.rank)<parseInt(e.rank)?-1:parseInt(t.rank)>parseInt(e.rank)?1:0}),o=stir.compose(o,i,s)(a),u=(i={currentPage:e,totalPosts:o.length,start:(e-1)*n.postsPerPage,end:(e-1)*n.postsPerPage+n.postsPerPage}).totalPosts<i.end?i.totalPosts:i.end,c=stir.Object.extend({},n,i,{last:u}),s=stir.filter(function(t,e){return e>=c.start&&e<u}),a=k(r.feeSpanders,c);stir.compose(t,a,s)(o)}var t=stir.nodes("[data-scholcountrylisting]"),r=stir.nodes("[data-scholsubjectlisting]"),a="localhost"==window.location.hostname||"mediadev.stir.ac.uk"==window.location.hostname,s=stir.node("#scholarship-search__nationality"),i=stir.node("#scholarship-search__subject"),o=stir.node("#scholarship-search__level"),u=stir.node("#scholarship-search__feestatus"),c=stir.node("#scholarship-search__form"),d=stir.node("#scholarship-search__results"),p=stir.node("#scholarship-search__clear"),g=stir.t4Globals.regionmacros||[],f={debug:a,regions:{ukroi:stir.flatten(g.filter(function(t){return"UK and ROI"===t.tag}).map(function(t){return t.data}))},regionmacros:stir.filter(function(t){if(t.tag)return t},g)||[],feeSpanders:[{short:"RUK",long:"England, Wales, NI, Republic of Ireland"},{short:"European",long:"European Union"},{short:"International",long:"International"},{short:"Scotland",long:"Scotland"}],nodes:{inputNation:s,inputSubject:i,inputLevel:o,inputFeeStatus:u,searchForm:c,resultsArea:d,searchClearBtn:p}},h={postsPerPage:30,noPageLinks:9},y=stir.curry(function(t,e,r){if(r.title&&P(e,r,t))return r}),m=stir.curry(function(t,e){return{rank:O(t,e),scholarship:e}}),v=function(t,e,r){return!r.includes(e)&&t.includes("All international")},b=function(e,t){if(!t||t.length)return!1;t=t.map(function(t){return e.includes(t)});return stir.any(function(t){return t},t)},P=function(t,e,r){var n,a,r=[(n=e.studyLevel,a=t.studyLevel,n.includes(a)),(n=e.feeStatus,a=t.feeStatus,n.includes(a)),(n=e,a=t.subject,n.otherSubject.toLowerCase().includes(a.toLowerCase())||n.promotedSubject.toLowerCase().includes(a.toLowerCase())),(n=e.faculty,a=t.faculty,n.includes(a)||n.includes("All Faculties")),(a=e.nationality,n=t.nation,e=t.regions,t=r.regions.ukroi,a.includes(n)||a.includes("All nationalities")||v(a,n,t)||b(a,e))];return stir.all(function(t){return t},r)},j=function(t,e){return t.toLowerCase().indexOf(e.toLowerCase())},S=function(t,e,r){return String(e+parseInt(t)+r)},O=function(t,e){var r=function(t,e){if(""===e.sortBy){if(""!==t.ugOrder)return t.ugOrder;if(""!==t.pgOrder)return t.pgOrder}return"ugOrder"===e.sortBy?t.ugOrder:"pgOrder"===e.sortBy?t.pgOrder:"ugOrderFaculty"===e.sortBy?t.ugOrderFaculty:"pgOrderFaculty"===e.sortBy?t.pgOrderFaculty:"1000"}(e,t),r=stir.isNumeric(parseInt(r))?r:"1000",r=n(e.nationality,t.nation,r,-1e4),r=b(e.nationality,t.regions)?S(r,-100,0):r,r=n(e.promotedSubject,t.subject,r,-2e4);return n(e.faculty,t.faculty,r,-2e4)},k=stir.curry(function(e,t,r){return'\n        <p class="u-margin-bottom"> Displaying  '.concat(t.start+1," - ").concat(t.last,"  of  \n            <strong>").concat(t.totalPosts," results</strong> that match your criteria.</p>\n        \n            ").concat(stir.map(function(t){return L(e,t)},r).join(""),' \n\n        <div class="grid-x grid-padding-x u-padding-top" id="pagination-box">\n            ').concat(I(t),"\n        </div> ")}),I=function(t){return t.postsPerPage>t.totalPosts?"":StirSearchHelpers.formPaginationHTML(t.totalPosts,t.postsPerPage,t.currentPage,t.noPageLinks)},L=function(t,e){return'\n        <div class="u-margin-bottom">\n            <div class="grid-x grid-padding-x">\n                <div class="cell small-12 medium-12 large-10 u-mb-2">\n                <h3 class="u-heritage-green u-mb-1">\n                    <a href="'.concat(e.scholarship.url,'">').concat(e.scholarship.title,"</a></h3>\n                    <p>").concat(e.scholarship.teaser,"</p> \n                </div>\n\n              ").concat(F((r=e.scholarship.feeStatus,n=t,r.split(", ").map(function(e){var t=stir.filter(function(t){if(t.short===e)return t},n);return t[0]?t[0].long:e}).join(", ")),"Fee status"),"\n              ").concat(F((t=e.scholarship.studyLevel,((r="desc")!==r?t.split(", ").sort():t.split(", ").sort().reverse()).join(", ")),"Level"),'\n      \n                <div class="cell small-12">\n                  <a href="').concat(e.scholarship.url,'" class="c-link" aria-label="View \n                  ').concat(e.scholarship.title,'" >').concat(e.scholarship.title,"</a>\n                  ").concat(a&&e?w(e):"","\n                </div>\n            </div>\n        </div>");var r,n},F=function(t,e){return t?'\n        <div class="cell small-12 medium-6 large-5 u-mb-2">\n          <div class="u-bg-grey u-p-2  u-green-line-left u-h-full">\n            <p class="u-font-bold">'.concat(e,'</p>\n            <p class="u-m-0">').concat(t,"</p>\n          </div>\n        </div> "):""},w=function(t){return'\n        <div class="u-my-2 u-p-2 u-border-solid " >\n          <h3>Debugger</h3>\n          <b>Weighting: </b> '.concat(t.rank,"\n          <br><b>Nationalities (M):</b> ").concat(t.scholarship.nationality,"\n          <br><b>Promoted (R):</b> ").concat(t.scholarship.promotedSubject,"\n          <br><b>Other (Q):</b> ").concat(t.scholarship.otherSubject,"\n          <br><b>Order (UG, PG):</b> ").concat(t.scholarship.ugOrder,", ").concat(t.scholarship.pgOrder,"\n          <br><b>Faculty:</b> ").concat(t.scholarship.faculty,"\n          <br><b>Faculty Order (UG, PG):</b> ").concat(t.scholarship.ugOrderFaculty," , ").concat(t.scholarship.pgOrderFaculty,"</p>\n        </div>")},x=stir.curry(function(t,e){return t.innerHTML=e,t}),_=stir.curry(function(t,e){return e.data.includes(t)?e.tag:"!No findy me!"}),N=function(t){return t.options[t.selectedIndex].value||""},B=function(t,e){if(!e)return"";if("Faculty"===t){if(e.includes("Undergraduate"))return"ugOrderFaculty";if(e.includes("Postgraduate"))return"pgOrderFaculty"}return e.includes("Undergraduate")?"ugOrder":e.includes("Postgraduate")?"pgOrder":void 0},U=function(t,e){return!e||"Faculty"===t||"!padrenullquery"===e?"":e.toLowerCase()},A=function(t,e){return!e||"Subject"===t||"!padrenullquery"===e?"":e},D=function(t){return t?"Postgraduate Taught"===t?"Postgraduate (taught)":"Postgraduate Research"===t?"Postgraduate (research)":t:""},q=function(t){return t&&0<t.length?t:""};if(c&&d){var E=stir.jsonscholarships.scholarships||[];if(!E.length)return;c.addEventListener("submit",function(t){t.preventDefault();e(!1,1,f,h,E),stir.scrollToElement&&stir.scrollToElement(d,20);t={page:1,nationality:s.options[s.selectedIndex].value,subject:i.options[i.selectedIndex].value,level:o.options[o.selectedIndex].value,feestatus:u.options[u.selectedIndex].value};QueryParams.set(t)});function C(t){QueryParams.set({page:t}),e(!1,t,f,h,E),stir.scrollToElement(c,-40)}d.addEventListener("click",function(t){var e;t.target.matches("#pagination-box a")&&(e=t.target.getAttribute("data-page"),C(e),t.preventDefault()),t.target.matches("#pagination-box a span")&&(e=t.target.parentNode.getAttribute("data-page"),C(e),t.preventDefault())},!1),p&&(p.onclick=function(t){return QueryParams.set({page:1,nationality:"",subject:"!padrenullquery",level:"",feestatus:""}),e(!0,1,f,h,E),stir.scrollToElement(c,-40),t.preventDefault(),!1});g=stir.isNumeric(QueryParams.get("page"))?QueryParams.get("page"):1;e(!0,g,f,h,E)}function G(n,a,s){return a.dataset.country.split(", ").map(function(t){t=t,e=n.regionmacros;var t={subject:"",subjectType:"",nation:t,studyLevel:a.dataset.studylevel,feeStatus:"",faculty:"",sortBy:a.dataset.studylevel.includes("Postgraduate")?"pgOrder":"ugOrder",regions:stir.map(_(t),e)},e=stir.filter(y(n,t)),t=stir.map(m(t)),r=stir.filter(function(t){return parseInt(t.rank)<1e3});return stir.compose(r,t,e)(s)})}var Q=stir.curry(function(t){return stir.map(function(t){return'<li data-rank="'.concat(t.rank,'"><a href="').concat(t.scholarship.url,'">').concat(t.scholarship.title,"</a> ").concat(a?t.rank:"","</li>")},t)}),T=stir.curry(function(t){return"<ul> ".concat(t.join("\n"),"</ul>")}),p={dev:"data.json",qa:"data.json",preview:"https://t4cms.stir.ac.uk/terminalfour/preview/1/en/29339/",prod:"/data/scholarships/json/index.json"};t.length&&stir.getJSON(p[UoS_env.name],function(n){n.length&&t.forEach(function(t){var e=x(t),r=stir.sort(function(t,e){return parseInt(t.rank)<parseInt(e.rank)?-1:parseInt(t.rank)>parseInt(e.rank)?1:0});return stir.compose(e,T,stir.removeDuplicates,Q,r)(stir.flatten(G(f,t,n)))})});r.length&&stir.getJSON(p[UoS_env.name],function(s){s.length&&r.forEach(function(t){var e={subject:t.dataset.subject,subjectType:"Subject",nation:"",studyLevel:t.dataset.studylevel,feeStatus:"",faculty:"",sortBy:t.dataset.studylevel.includes("Postgraduate")?"pgOrder":"ugOrder",regions:[]},r=stir.filter(y(f,e)),e=stir.map(m(e)),n=stir.sort(function(t,e){return parseInt(t.rank)<parseInt(e.rank)?-1:parseInt(t.rank)>parseInt(e.rank)?1:0}),t=x(t),a=stir.filter(function(t,e){return e<5});return stir.compose(t,T,Q,a,n,e,r)(s)})})}();