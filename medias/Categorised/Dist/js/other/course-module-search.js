!function(){var e=stir.node("#filters_panel__startdate");if(!e)return;const s={yearStartMonth:"08",yearEndMonth:"07",switchMonth:"09"};const i=(e,t)=>`
        <fieldset>
          <legend>${String(t.start).slice(0,4)}/${String(t.end).slice(2,4)} </legend>
          ${stir.join("",stir.map(r,e))}
        </fieldset>`,r=e=>`    
      <div class=" c-search-filters-panel__filter">
        <label><input type="checkbox" name="startdate" value="${e.name}">
        ${e.name}
        </label>
      </div>`,l=stir.curry((e,t)=>(e.innerHTML=t,e)),t=parseInt(stir.T4Globals.startyear);var a=stir.T4Globals.startdates.startdates||{};if(a.length){n=t;var n=stir.isNumeric(n)&&4===t.toString().length&&t.toString().slice(0,2)===(new Date).getFullYear().toString().slice(0,2)?t:((e,t,r,a)=>{e=t<r?e-1:e;return t>=parseInt(a)&&t<parseInt(r)?e+1:e})((new Date).getFullYear(),(new Date).getMonth()+1,s.yearStartMonth,s.switchMonth),n=[{year:n,node:e.children[0]},{year:n+1,node:e.children[1]}];const c=((e,t)=>{t=String(t).length<2?"0"+String(t):String(t);return parseInt(String(e)+t)})((new Date).getFullYear(),(new Date).getMonth()+1);var e=stir.sort((e,t)=>parseInt(e.num)<parseInt(t.num)?-1:parseInt(e.num)>parseInt(t.num)?1:0),o=stir.filter(e=>e.num>=c);const u=stir.compose(o,e)(a);stir.map(e=>{var t,r,a,n;if(e.node)return n=e.year,t=s.yearStartMonth,r=s.yearEndMonth,t={year:n,start:parseInt(n+t),end:parseInt(n+1+r)},a=t,n=u,r=stir.filter(e=>parseInt(e.num)>=a.start&&parseInt(e.num)<a.end,n),i(r,t).length?l(e.node,i(r,t)):e.node.classList.add("hide")},n)}}(),function(){var Q=-1===window.location.hostname.indexOf("stir.ac.uk");const $=Q?"stage-shared-15-24-search.clients.uk.funnelback.com":"search.stir.ac.uk";var w,n,O=`https://${$}/s/search.json?`,t=document.querySelector("form#course-search"),e=t.querySelectorAll('input[type="hidden"]'),s=t.querySelector("#course-search__query"),a=t.querySelector("#search-ordered-filters"),r=t.querySelector("#filters-menu"),i=t.querySelector("#search__filters"),l=i?i.querySelectorAll("input[type=checkbox]"):[],o=t.querySelector('[name="subject"]'),B=(window.location.hostname,"stiracuk-cms01-production.terminalfour.net"===window.location.hostname),c=document.getElementById("course-search__loading"),u=document.getElementById("course-search__results"),b=document.getElementById("course-search__summary"),d=document.createElement("div"),C=document.getElementById("btnClearSubs"),N="",S=document.createElement("p"),L=new stir.indexBoard(document.querySelector("#search-letters__links")),q="!padrenullquery",D=q,j="",E="",M="",A="",P="",H="",m={query:D,start_rank:1,sort:""},U={description:"Continuing Professional Development (CPD) module. Enrol now to gain new skills and up-to-date knowledge for your career development."};const F=()=>{m.sort="!"===D.charAt(0)?"title":"",stir.getJSON(O+stir.Concierge.prototype.obj2param(m),G)};function h(){var e;w?F():(e={dev:"combo-links.json",qa:"combo-links.json",preview:stir?.t4Globals?.search?.comboLinks||"",prod:"https://www.stir.ac.uk/media/stirling/feeds/combo-links.json"},Q&&console.info(`[Search] Getting combo data for ${UoS_env.name} environment (${e[UoS_env.name]})`),stir.getJSON(e[UoS_env.name],e=>{w=e&&!e.error?e.slice(0,-1):[],F()}))}function G(e){e.error?(u.appendChild(stir.getMaintenanceMsg()),c.style.display="none",console.error(e.error)):(n=e,c.style.display="none",u.innerHTML=g(n),a&&a.classList.add("stir__slidedown"),i&&i.classList.add("stir__slidedown"),L.show(),stir.scrollToElement(t,-40))}function I(e,t){if(e&&t){e=e.split(", ").join(","),t=t.split(", ").join(",");for(var r=e.split(","),a=0;a<r.length;a++)if(0<=t.split(",").indexOf(r[a]))return!0}return!1}f={module:"CPD module"};var f,p=function(e,t,r){return'<button class="is-active" data-filter-name="'+e+'" data-filter-value="'+t+'">'+(r in f?f[r]:r)+" Ã—</button>"};function T(e,t){return'<a href="'+t+'">'+e+"</a>"}function g(e){var t,r=[],a=e.response.resultPacket.results,n=e.response.curator.exhibits;const s=/BSc |BAcc |BA |\(Hons\) ?\/? ?/g;L.reset();for(var i,l,o,c=0;c<n.length;c++)!n[c].titleHtml||H&&n[c].titleHtml.charAt(0)===H||r.push((i=n[c].titleHtml,l=n[c].linkUrl,o=n[c].descriptionHtml,['<div class="small-12 large-9 cell c-clearing-list-item" data-sid="">','<p class="c-clearing-list-item__link"><a href="'+l+'">'+i+"</a></p>",'<p class="c-clearing-list-item__summary">'+o+"</p>","</div>"].join("")));for(var u,d,m,c=0;c<a.length;c++){var h,f,p,g,v,y,_,k=a[c];k.displayUrl&&(_=!0,(_=(_=(_=(_=(_=j?I(j,(k.metaData.level||k.metaData.type||"").replace(" (taught)","")):_)&&M?I(M,k.metaData.M):_)&&E?I(E,(k.metaData.A||"").replace("Faculty of ","")):_)&&A?I(A,k.metaData.sdt):_)&&P?I(P,k.metaData.subject):_)&&L.enable(k.title.charAt(0)),_=(!H||k.title.charAt(0)===H)&&_)&&(_=!(!k.metaData.type||"module"!=k.metaData.type),h=k.metaData.award?k.metaData.award+" ":"",f=k.metaData.ucas?" - "+k.metaData.ucas:"",_=k.metaData.c||(_?U.description:""),p="https://"+$+k.clickTrackingUrl,g=k.metaData.sid||"",v=k.metaData.provider||"",B&&(p="https://stiracuk-cms01-production.terminalfour.net/terminalfour/preview/1/en/"+g),k.collection&&"stir-combos"===k.collection?(y=h+` ${w.filter(e=>e.sid===parseInt(k.metaData.sid))[0].courses.map(e=>`<a href="${e.url}" title="${e.text}">${e.text.replace(s,"")}</a>`).join(" and ")} `+f,_=_||""):y=h+` ${h="",u=k.title,d="",m=k.metaData.combo,p=p,m?1==(m=JSON.parse(m)).length?h+T(u,p)+" and "+T(m[0].title,m[0].link)+d:2==m.length?h+T(u,p)+", "+T(m[0].title,m[0].link)+" and "+T(m[1].title,m[1].link)+d:T(h+u+d,p):T(h+u+d,p)} `+f,r.push((m=y,h=_,[`<div class="small-12 large-9 cell c-clearing-list-item" data-sid="${g}" data-provider="${0<=v.indexOf("Forth Valley")?"FV":""}">`,`<p class="c-clearing-list-item__link"><strong>${m}</strong></p>`,`<p class="c-clearing-list-item__summary">${h}</p>`,"</div>"].join(""))))}return e=(0<r.length?"Showing <strong>"+r.length.toString():"<strong>No ")+" results</strong>",t="!"!==D.charAt(0)&&D?" for &ldquo;"+stir.String.stripHtml(D)+"&rdquo;":"",b.innerHTML="<p>"+e+t+(0<r.length?":":".")+"</p>",D&&q!==D&&(N="https://www.stir.ac.uk/search/?query="+encodeURI(D),S.innerHTML='Not looking for a course? <a href="'+N+'" class="c-link" id="course-search-to-main">Search the rest of the website for &ldquo;'+stir.String.stripHtml(D)+"&rdquo;</a>"),L.update(),'<div class="grid-x">'+r.join("\n")+"</div>"}function v(){b.innerHTML="",u.innerHTML="",S.innerHTML="",c.style.display="block",s&&(s.value=D),D===q&&s&&(s.value="")}function J(e){var t={level:[],method:[],faculty:[],startdate:[]};H="";for(var r=0;r<l.length;r++)l[r].name&&l[r].value&&l[r].checked&&t[l[r].name].push(l[r].value);j=t.level.join(","),M=t.method.join(","),E=t.faculty.join(","),A=t.startdate.join(","),QueryParams.set("filter__level",j),QueryParams.set("filter__method",M),QueryParams.set("filter__faculty",E),QueryParams.set("filter__startdate",A),a&&Y(),u.innerHTML=g(n)}function Y(){if(a){var e=[];a.innerHTML="";for(var t=0;t<l.length;t++)0<=j.indexOf(l[t].value)?(l[t].checked=!0,e.push(p("level",l[t].value,l[t].value))):0<=M.split(",").indexOf(l[t].value)?(l[t].checked=!0,e.push(p("method",l[t].value,l[t].value))):0<=E.indexOf(l[t].value)?(l[t].checked=!0,e.push(p("faculty",l[t].value,l[t].value))):0<=A.indexOf(l[t].value)&&(l[t].checked=!0,e.push(p("startdate",l[t].value,l[t].value)));a.innerHTML=e.join(" ")}}function V(){a&&(a.classList.add("stir__slideup"),a.classList.remove("stir__slidedown")),i&&(i.classList.add("stir__slideup"),i.classList.remove("stir__slidedown")),L.hide()}t.addEventListener("submit",function(e){e.preventDefault(),(D=s.value)?(QueryParams.set("query",D),m.query=D):(QueryParams.remove("query"),m.query=q),V(),v(),h(),o&&(o.value="")}),document.querySelector("#search-letters__links")&&document.querySelector("#search-letters__links").addEventListener("click",function(e){e.target.dataset.disabled||(H=e.target.dataset.letter===H?"":e.target.dataset.letter,u.innerHTML=g(n)),e.preventDefault()}),r&&r.addEventListener("click",function(e){var t=document.getElementsByClassName("c-search-filters-panel");this.querySelectorAll(".is-active").forEach(function(e){e.classList.remove("is-active")}),e.target.classList.add("is-active");for(var r,a=0;a<t.length;a++)t[a].style.display="none";e.target.hasAttribute("data-menu-id")&&(r=document.getElementById(e.target.getAttribute("data-menu-id")))&&(r.style.display="flex"),e.preventDefault()}),a&&a.addEventListener("click",function(e){e.target&&e.target!==this&&e.target.parentNode.removeChild(e.target);for(var t=e.target.hasAttribute("data-filter-name")?e.target.getAttribute("data-filter-name"):void 0,r=e.target.hasAttribute("data-filter-value")?e.target.getAttribute("data-filter-value"):void 0,a=0;a<l.length;a++)l[a].name===t&&l[a].value===r&&(l[a].checked=!1);J()});r=document.querySelector(".c-search-letters__toggle-link");r&&r.addEventListener("click",function(e){document.querySelector("#search-letters__links").classList.toggle("show-for-medium"),e.preventDefault()}),C&&C.addEventListener("click",function(e){o.value="",P="",v(),h(),e.preventDefault()}),d.setAttribute("class","course-search__footer"),u.insertAdjacentElement("afterend",d),d.appendChild(S);for(var y,_=0;_<e.length;_++)m[e[_].name]=e[_].value;for(var R=["filters_panel__method","filters_panel__faculty","filters_panel__startdate"],k=0;k<R.length;k++){var z=document.getElementById(R[k]);z&&(z.style.display="none")}if(V(),i&&i.addEventListener("change",J),QueryParams.get("query")&&(D=QueryParams.get("query")),QueryParams.get("filter__level")&&(j=QueryParams.get("filter__level")),QueryParams.get("filter__method")&&(M=QueryParams.get("filter__method")),QueryParams.get("filter__faculty")&&(E=QueryParams.get("filter__faculty")),QueryParams.get("filter__startdate")&&(A=QueryParams.get("filter__startdate")),""===j&&(y=[],(i?Array.prototype.slice.call(i.querySelectorAll('input[type=checkbox][name="level"]:not([disabled])')):[]).forEach(function(e){y.push(e.value)}),j=y.join(","),QueryParams.set("filter__level",j)),Y(),o){var x="https://www.stir.ac.uk/data/subjects/index.js";switch(window.location.hostname){case"localhost":case"mediadev.stir.ac.uk":x="subjects.js";break;case"stiracuk-cms01-production.terminalfour.net":x="https://stiracuk-cms01-production.terminalfour.net/terminalfour/preview/1/en/24197"}stir.getJSON(x,function(e){if(e&&e.subjects){var t=o,r=e.subjects;if(t&&r){r.sort(function(e,t){return e.name>t.name});for(var a=0;a<r.length;a++)t.appendChild(new Option(r[a].name,r[a].value))}o.addEventListener("change",function(){P=this.value,u.innerHTML=g(n),b.innerHTML=""!==P?'<p>Showing results for subject "'+P+'"</p>':"<p>Showing results for all subjects </p>",s.value="",stir.scrollToElement(o)})}})}m.query=D,v(),h()}();