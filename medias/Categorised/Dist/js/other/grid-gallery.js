!function(){var l,t,c,s,h=[];if((l=document.querySelector("[data-gallery]"))&&(t=document.getElementById("template-pswp"))){var e=t=>t&&document.querySelector(t),i=t=>t&&t.innerText,r=t=>t&&t.split("|").shift().trim();const u=r(i(e("title")))||r(i(e("h1")));(r=document.createElement("div")).insertAdjacentHTML("afterbegin",t.innerHTML),document.body.appendChild(r.firstChild),(c="gallery"+l.getAttribute("data-gallery"))&&window[c]&&(i=stir.Number.clamp(parseInt(l.getAttribute("data-max"))||window[c].length,1,window[c].length),l.style.setProperty("--num-rows",Math.ceil(i/3)),window[c].slice(0,i).forEach((t,e)=>{var i,r,a,n=document.createElement("li"),o=(d=t.o_width,i=t.o_height,{factor:r=(r=1024)<(o=i<d?d:i)?r/o:1,width:Math.round(d*r),height:Math.round(i*r)}),d=new Image(o.w,o.h);o.width<o.height&&n.classList.add("portrait"),s="https://farm"+t.farm+".staticflickr.com/"+t.server+"/"+t.id+"_"+t.secret,d.setAttribute("data-bgimage",s+"_c.jpg"),d.setAttribute("width",o.width),d.setAttribute("height",o.height),d.setAttribute("alt",t.title||u||`Image ${e} of `+window[c].length),d.setAttribute("data-gallery-index",e),n.appendChild(d),h.push({src:s+"_c.jpg",w:o.width,h:o.height,title:t.title}),a=stir.createIntersectionObserver({element:n,threshold:[.9],callback:function(t){(-1==t.intersectionRatio||0<t.intersectionRatio)&&((t=this.querySelector("[data-bgimage]")).src=t.getAttribute("data-bgimage"),t.removeAttribute("data-bgimage"),a)&&a.observer.unobserve(this)}}),l.insertAdjacentElement("beforeend",n)}),"undefined"!=typeof PhotoSwipe?(l.addEventListener("click",function(t){t.preventDefault(),new PhotoSwipe(document.querySelectorAll(".pswp")[0],PhotoSwipeUI_Default,Array.prototype.slice.call(h),{index:parseInt(t.target.getAttribute("data-gallery-index"))}).init()},!0),l.addEventListener("load",function(t){t.target.parentNode.setAttribute("data-loaded",!0)},!0)):console.error("PhotoSwipe not available!"))}}();