var StirUniModules=function(){function e(){var e=document.createElement("div"),t=['\t<div class="loader"></div>','\t<span class="show-for-sr">Loading modules...</span>'];return e.setAttribute("id","course-modules-container__loading"),e.classList.add("course-modules__loading"),e.insertAdjacentHTML("afterbegin",t.join("\n")),e}function t(e){var e=y(e),t=document.querySelector(e.container);if(t){for(var o in Y)t.insertAdjacentElement("beforeend",Y[o]);t.insertAdjacentElement("beforeend",K.el)}}function o(e,t,o){if(j=e.replace(/\s/g,"").split(","),D=t,o=y(o),1===j.length&&j[0])s(j[0],t,o);else{var n={UG:I+"?opt=menu&callback=StirUniModules.showCourseRoutes",PG:I+"?opt=pgmenu&ct=PG&callback=StirUniModules.showCourseRoutes"};$.ajax({url:n[t],dataType:"script",cache:!0,success:function(e){},error:function(){_("_loadCourseRoutes"),r()}})}}function n(e,t){return e.collectionStatusCode===t.collectionStatusCode?0:e.collectionStatusCode.indexOf("E")>=0&&t.collectionStatusCode.indexOf("E")>=0?0:e.collectionStatusCode.indexOf("E")>=0?1:t.collectionStatusCode.indexOf("E")>=0?-1:0}function i(e){var t=y(),o=[],n=0;if(t.show_all_routes)return Z(e);for(var i=0;i<e.length;i++)n=j.indexOf(e[i].rouCode),n>=0&&(o[n]=e[i]);o.length>0&&(Z(o),t.autoload_first_route&&s(o[0].rouCode,D))}function r(e){z(e)}function s(e,t,o){D=t,B=e,b(),o=y(o),g("_loadCourseOptions");var n={UG:I+"?opt=ug-opts&rouCode="+e+"&ct=UG&callback=StirUniModules.showCourseOptions",PG:I+"?opt=pg-opts&rouCode="+e+"&ct=PG&callback=StirUniModules.showCourseOptions"};X=n[t];var i=V(X);o.use_cache&&void 0!==i?(_("_loadCourseOptions [CACHE]"),d(i)):$.ajax({url:X,dataType:"script",cache:!0,success:function(){_("_loadCourseOptions [OK]")},error:function(){_("_loadCourseOptions [ERROR]"),l()}})}function a(e){var t=e[2],o=e[3];return"F"!==t.charAt(0)||"Autumn"!==o}function c(e){return e.filter(a)}function d(e){if(options=y(),e=c(e),Q(X,e),1===e.length){var t=e.pop();u(B,t[0],t[2])}else if(ee(e),options.autoload_first_option){var t=e.shift();u(B,t[0],t[2])}}function l(e){te(e)}function u(e,t,o){options=y(),g("_loadCourseModules");var n={UG:"opt=runcode&moa="+t+"&occ="+o+"&ct=UG",PG:"opt=runpgcode&moa="+t+"&occ="+o+"&ct=PG"};X=I+"?"+n[D]+"&rouCode="+e+"&callback=StirUniModules.showCourseModules";var i=V(X);return options.use_cache&&void 0!==i?(m(i),void _("_loadCourseModules [CACHE]")):void $.ajax({url:X,dataType:"script",cache:!0,success:function(e){_("_loadCourseModules [OK]")},error:function(){p(),_("_loadCourseModules [ERROR]")}})}function m(e){Q(X,e),oe(e)}function p(e){re(e)}function h(e,t,o,n){options=y(),X=q+"/module/get/"+e+"/"+n+"/"+t+"/"+o+"/jsonp?status=complete&client=externalweb&callback=StirUniModules.showModule";var i=V(X);return options.use_cache&&void 0!==i?f(i):void $.ajax({url:X,dataType:"script",cache:!0,success:function(e){},error:function(){v({details:[e,t,o,n]})}})}function f(e){Q(X,e),ie(e)}function v(e){re(e)}function g(e){ce(e)}function _(e){de(e)}function S(e){return"https://portal.stir.ac.uk/calendar/calendar"+("PG"==StirUniModules.getCourseType()?"-pg":"")+".jsp?modCode="+e}function M(e){return G[e]}function y(e){return e||(e={}),G=stir.Object.extend({autoload_first_route:!1,autoload_first_option:!1,auto_expand_first_accordion:!0,use_cache:!0,collapse_collection_headers:!1,hide_modules_if_not_available:!1},G,e)}function w(e){G.show_all_routes=!!e}function b(){N="UXX28-CWP"===B.substring(0,9)||"UXX19-EYP"===B.substring(0,9)||"UHC12-TRNINT"===B?3:2}function C(e){I=e}function L(e){Z=e}function E(e){z=e}function U(e){ee=e}function T(e){te=e}function k(e){oe=e}function A(e){ne=e}function O(e){ie=e}function x(e){re=e}function R(e){ce=e}function H(e){de=e}var I="https://portal.stir.ac.uk/servlet/CalendarServlet",q="https://portal.stir.ac.uk/api/ssoc",G={},j=[],B="",D="",N=2,P={truncateModuleCollection:"c-course-modules__accordion-content--hide-rows"},W={getYear:function(e){return Math.ceil(e/N)},getSemesterYearIndex:function(e){var t=e%N;return 0===t?N:t}},Y=function(){for(var e={},t=["routes-list","options-list","initial-text","accordion"],o="course-modules-container__",n=0;n<t.length;n++)e[t[n]]=document.createElement("div"),e[t[n]].id=o+t[n];return e}(),F={},X="",K={el:e(),queue:0},Q=function(e,t){F[e]=JSON.parse(JSON.stringify(t))},V=function(e){return F[e]},J=function(){function e(){this.classList.remove("c-callout"),this.classList.remove("info"),this.innerHTML=""}return{reset:e.bind(Y["initial-text"])}}(),Z=function(e){options=y();var t=[];t.push("<p>Please select your preferred route from the options below to list modules for this course:</p>"),t.push("<select>");for(var o in e)t.push('<option data-route-code="'+e[o].rouCode+'" data-course-type="'+D+'">'+e[o].rouName+"</option>");t.push("</select>"),options.container.insertAdjacentHTML("afterbegin",t.join(""))},z=function(e){console.error("There was a problem loading course routes data",e)},ee=function(e){options=y();var t=[];t.push("<p>There are "+e.length+" routes for this course:</p>"),t.push("<ul>");for(var o in e)t.push('<li><a href="#" data-roucode="'+StirUniModules.getSelectedRoute()+'" data-moa="'+e[o][0]+'" data-occ="'+e[o][2]+'" data-function="getmods">Starting '+e[o][3]+", "+e[o][4]+" "+e[o][1]+"</a></li>");t.push("</ul>"),options.container&&(options.container.innerHTML=t.join(""))},te=function(e){console.error("There was a problem loading course options data",e)},oe=function(e){console.error("showCourseModulesRenderer() is not defined")},ne=function(e){console.error("There was a problem loading modules data",e)},ie=function(e){console.error("showModuleRenderer() is not defined")},re=function(e){console.error("showModuleErrorRenderer() is not defined")},se=function(){return B},ae=function(){return D},ce=function(){console.error("Show loading renderer not defined")},de=function(){console.error("Hide loading renderer not defined")};return{init:t,loading:K,moduleSort:n,initialText:J,DOM:Y,loadCourseRoutes:o,showCourseRoutes:i,loadCourseOptions:s,showCourseOptions:d,loadCourseModules:u,showCourseModules:m,loadModule:h,showModule:f,showLoading:g,hideLoading:_,setCalendarUrl:C,getSelectedRoute:se,getOption:M,getOptions:y,getCourseType:ae,getDPTModuleLink:S,setOptionShowAllRoutes:w,setShowRoutesRenderer:L,setShowRoutesErrorRenderer:E,setShowOptionsRenderer:U,setShowOptionsErrorRenderer:T,setShowModulesRenderer:k,setShowModulesErrorRenderer:A,setShowModuleRenderer:O,setShowModuleErrorRenderer:x,setShowLoadingRenderer:R,setHideLoadingRenderer:H,semester:W,css:P}}(),stir=stir||{};stir.t4Globals=stir.t4Globals||{},stir.t4Globals.countries=stir.t4Globals.countries||[],function(e){function t(){var e=[];e.push('<option value="'+r+'">'+r+"</option>");for(var t in s)s[t].name&&e.push('<option value="'+s[t].name+'">'+s[t].name+"</option>");f.innerHTML=e.join("\n")}function o(e){var t=document.getElementById(e);return t?t.innerHTML:""}function n(){var e={name:r,ugEntryYearOne:o(d),ugEntryYearTwo:o(l),englishRequirements:o(u),pgRequirements:o(m),pgRequirementsSMS:""};s.push(e)}function i(e){for(var t in s){var o=document.createElement("textarea");if(s[t].name===e){if("ug"===v){var n=document.getElementById(d);n&&(o.innerHTML=s[t].ugEntryYearOne,n.innerHTML=o.value);var i=document.getElementById(l);i&&(o.innerHTML=s[t].ugEntryYearTwo,i.innerHTML=o.value,i.parentElement.classList.remove("hide"),o.value.trim().length<1&&i.parentElement.classList.add("hide"))}if("pg"===v){var r=document.getElementById(m);r&&(o.innerHTML=s[t].pgRequirements,"China"===s[t].name&&"Stirling Management School"===c&&(o.innerHTML=s[t].pgRequirementsSMS),r.innerHTML=o.value)}}}}if(e){var r="United Kingdom",s=stir.t4Globals.countries,a=document.getElementsByTagName("meta"),c="",d="panelYear1",l="panelYear2",u="panelEngReqs",m="panelEntryReqs",p=document.getElementById("accordionOtherScotQuals"),h=document.getElementById("accordionOtherQuals"),f=e,v=f.dataset.level||"";a["stir.course.faculty"]&&(c=a["stir.course.faculty"].content),t(),n(),f.onchange=function(e){var t=this.options[this.selectedIndex].value;t!==r?(p&&p.closest(".stir-accordion").classList.add("hide"),h&&h.closest(".stir-accordion").classList.add("hide")):(p&&p.closest(".stir-accordion").classList.remove("hide"),h&&h.closest(".stir-accordion").classList.remove("hide")),i(t),e.preventDefault()}}}(document.querySelector("select[name='course-countries-select']"));var stir=stir||{};stir.t4Globals=stir.t4Globals||{},function(){function e(){var e=window.scrollY;s&&n&&(e>o&&n.classList.add("stir__slidedown"),e<o&&n.classList.remove("stir__slidedown"))}function t(){window.requestAnimationFrame(e)}var o,n=document.querySelector(".c-course-title-sticky-menu"),i=document.querySelector("#course-sticky-close-btn"),r=document.querySelector(".c-course-title__buttons"),s=!0;"small"!==stir.MediaQuery.current&&(n&&(n.classList.add("stir__slideup"),n.style.display="block"),r&&n&&(o=r.offsetTop+r.offsetHeight,window.addEventListener("scroll",t)),i&&(i.onclick=function(e){s=!1,window.removeEventListener("scroll",t),n.parentNode.removeChild(n),e.preventDefault()}))}(),stir.components=stir.components||{},stir.components.html=stir.components.html||{},stir.components.unistats=stir.components.unistats||{},stir.components.foundation=stir.components.foundation||{},stir.components.discoveruni=stir.components.discoveruni||{},stir.components.unistats.widget=function(e){var t=document.createElement("iframe");return t.src="https://widget.unistats.ac.uk/Widget/10007804/"+kiscode+"/responsive/small/en-GB/"+kismode,t.setAttribute("title","Unistats widget for "+kiscode+" ("+kismode+")"),t.classList.add("c-course-unistats-widget"),t},stir.components.discoveruni.widget=function(e){var t=document.createElement("div");return t.setAttribute("data-institution",10007804),t.setAttribute("data-course",e.kiscode),t.setAttribute("data-kismode",e.kismode),t.setAttribute("data-orientation","responsive"),t.setAttribute("data-language","en-GB"),t},stir.components.html.details=function(e){var t=document.createElement("details");return e.summary&&(t.innerHTML="<summary>"+e.summary+"</summary>"),t},stir.components.foundation.accordion=function(e){var t=document.createElement("ul");return t.classList.add("accordion"),t.setAttribute("data-accordion",!0),e.id&&t.setAttribute("id",e.id),t},stir.components.foundation.accordionItem=function(e){var t=document.createElement("li"),o=document.createElement("a");return this.content=document.createElement("div"),t.classList.add("accordion-item"),t.setAttribute("data-accordion-item",!0),o.href="#",o.classList.add("accordion-title"),o.innerText=e.title||"Show more",this.content.classList.add("accordion-content"),this.content.setAttribute("data-tab-content",!0),this.content.setAttribute("aria-hidden",!0),this.content.style.display="none",t.appendChild(o),t.appendChild(this.content),t},stir.renderKISWidgets=function(e,t){var o="www.stir.ac.uk"!=window.location.hostname,t=t||document.querySelector("#kis-widget"),n=document.createDocumentFragment(),i=!1,r=/^U\d{2}-[A-Z]{3}([A-Z]{3})?$/,s=[];if(o&&(console.info("[Discover Uni] kiscodes:",e,e.length),console.info("[Discover Uni] kiswidget:",t)),t&&e){t.setAttribute("data-initialised",!0),t.innerHTML="",t.classList.remove("grid-x"),i=t.hasAttribute("data-unistats");for(var a=0;a<e.length;a++){var c=e[a].split(":")[0].trim(),d=e[a].split(":")[1]?"parttime":"fulltime";if(""===c)o&&console.info("[Discover Uni] Empty kiscode",a);else if(r.test(c)){var l;l=i?stir.components.unistats.widget({kiscode:c,kismode:d}):stir.components.discoveruni.widget({kiscode:c,kismode:d}),s.push(l)}else console.error("Invalid KIS code: "+c);l&&n.appendChild(l)}t.appendChild(n),function(e){if(!i&&!e.getElementById("unistats-widget-script")){var o=e.createElement("script");o.id="unistats-widget-script",o.src="https://discoveruni.gov.uk/widget/embed-script/",o.addEventListener("load",function(e){if(s.length>1&&window.DiscoverUniWidget){var o=!1,n=0,i="undefined"!=typeof Foundation,r=i?new stir.components.foundation.accordion({id:"morewidgets"}):new stir.components.html.details({id:"morewidgets",summary:"Show more"});t.insertAdjacentElement("afterend",r),i&&(r.appendChild(stir.components.foundation.accordionItem({title:"View more Discover Uni information"})),r=r.querySelector("[data-tab-content]")),DiscoverUniWidget.prototype._addCss=DiscoverUniWidget.prototype.addCss,DiscoverUniWidget.prototype.addCss=function(){o||this._addCss(),o=!0},DiscoverUniWidget.prototype._renderWidget=DiscoverUniWidget.prototype.renderWidget,DiscoverUniWidget.prototype.renderWidget=function(){this._renderWidget.apply(this,arguments),this.targetDiv.classList.contains("no-data")||++n>1&&r.appendChild(this.targetDiv)}}for(var a=0;a<s.length;a++)s[a].classList.add("kis-widget"),new DiscoverUniWidget(s[a]);i&&window.$&&new Foundation.Accordion($("#morewidgets"),{allowAllClosed:!0})}),document.head.appendChild(o)}}(document)}};var KISWidgetCaller=function(){return!1};!function(){function e(){var e=document.getElementById("clearing-banner-template"),t=document.querySelector(".c-course-title-sticky-menu"),o=document.querySelector(".c-course-datasheet");o&&e&&e.innerHTML&&(o.insertAdjacentHTML("afterend",e.innerHTML),t&&t.parentElement.removeChild(t))}function t(e){var t=document.querySelector(".c-course-datasheet");t&&e&&e.innerHTML&&t.insertAdjacentHTML("afterend",e.innerHTML)}function o(){var e=document.getElementById("course-ctas"),t=document.querySelector(".c-whats-next");e&&t&&(t.insertAdjacentElement("beforebegin",e),t.classList.remove("u-margin-top"),e.classList.add("u-margin-top"))}function n(){var e=document.getElementById("c-course-tabs");e&&(e.style.top="-1px")}self.stir&&stir.t4Globals&&stir.t4Globals.clearing&&stir.t4Globals.clearing.open&&stir.t4Globals.clearing.showPromos&&(e(),t(document.getElementById("clearing-advert-template")),new UoS_StickyWidget(document.querySelector(".u-sticky")),o(),n())}();var stir=stir||{};stir.t4Globals=stir.t4Globals||{},function(e){function t(e){1===this.nodeType&&(e?this.classList.remove("hide"):this.classList.add("hide"))}function o(e){t.call(e,!0)}function n(e){t.call(e,!1)}function i(){n(d),r().forEach(n)}function r(t){return Array.prototype.slice.call(e.querySelectorAll("[data-region"+(t?'="'+t+'"':"")+"]"))}function s(){i(),(a=this.options[this.options.selectedIndex].value)&&(o(d),r(a).forEach(o))}if(e){var a,c=e.querySelector("select"),d=e.querySelector("table");i(),c.addEventListener("change",s)}}(document.getElementById("course-fees-information")),StirUniModules.setShowRoutesRenderer(function(e){var t=StirUniModules.DOM.accordion,o=StirUniModules.DOM["routes-list"],n=StirUniModules.DOM["options-list"],i=document.createElement("select");i.id="course-modules-container__routes-select";for(var r=0;r<e.length;r++)"undefined"==typeof e[r]?console.error("Error with module code "+(r+1)):i.insertAdjacentHTML("beforeend",'<option value="'+e[r].rouCode+","+StirUniModules.getCourseType()+'">'+e[r].rouName+"</option>");o.insertAdjacentHTML("afterbegin","<p>Please choose a course:</p>"),o.appendChild(i),i.addEventListener("change",function(e){var o=$(this).val().split(","),i=o[0],r=o[1];for(StirUniModules.initialText.reset(),n.innerHTML="";t.firstChild;)t.removeChild(t.firstChild);StirUniModules.loadCourseOptions(i,r)})}),StirUniModules.setShowOptionsRenderer(function(e){var t=StirUniModules.DOM.accordion,o=StirUniModules.DOM["options-list"],n=document.createElement("select");n.id="#course-modules-container__options-select";for(var i=0;i<e.length;i++){var r=StirUniModules.getSelectedRoute()+","+e[i][0]+","+e[i][2],s="Starting "+e[i][3]+", "+e[i][1].toLowerCase();"Stirling"!==e[i][4]&&(s+=" ("+e[i][4]+")"),n.insertAdjacentHTML("beforeend",'<option value="'+r+'">'+s+"</option>")}o.innerHTML="<p>There are "+stir.cardinal(e.length)+" variants of this course. Please choose from the drop-down:</p>",o.appendChild(n),n.addEventListener("change",function(e){var o=this.options[this.selectedIndex].value.split(","),n=o[0],i=o[1],r=o[2];for(StirUniModules.initialText.reset();t.firstChild;)t.removeChild(t.firstChild);StirUniModules.loadCourseModules(n,i,r)})}),StirUniModules.setShowModulesRenderer(function(e){function t(){var e=document.getElementById("course-modules-description__header"),t=document.getElementById("course-modules-description__body"),o=document.getElementById("course-modules-description__loading"),n=document.getElementById("course-modules-description__content");e&&(e.innerHTML=""),t&&(t.innerHTML=""),$(o).show(),$(n).hide()}function o(e){t(),StirUniModules.loadModule(e.getAttribute("data-module-code"),e.getAttribute("data-semester-code"),e.getAttribute("data-occurrence"),e.getAttribute("data-year-session"))}function n(e){this.classList&&(this.classList.toggle(StirUniModules.css.truncateModuleCollection)?(stir.scrollToElement(this,60),e.target.innerText=viewMoreLinkText.replace("_X_",e.target.getAttribute("data-choices"))):e.target.innerText=viewLessLinkText,e.preventDefault())}function i(e){o(this),StirUniModules.getOptions().modal.open(),e.preventDefault()}var r=document.querySelector(StirUniModules.getOption("container"));if(r){var s="www.stir.ac.uk"!=window.location.hostname,a=r.querySelector("#course-modules-container__accordion"),c=[],d=r.querySelector("#course-modules-container__initial-text"),l=!!StirUniModules.getOption("auto_expand_first_accordion");viewMoreModulesThreshold=4,viewMoreLinkText="View all _X_ choices",viewLessLinkText="View fewer choices";var u,m,p,h,f,v,g,_,S,M,y,w=0,b=[],C=[];d&&(d.innerHTML=e.initialText?"<p>"+e.initialText+"</p>":"");for(var L=function(e){var t;return t=e.indexOf("E")>-1?"Option module":"D"===e?"Dissertation":"Compulsory module"},E=function(e,t){return L(e)+t},U=!1,T=0;T<e.semesterGroupBeans.length;T++)if(e.semesterGroupBeans[T].groupOptions.length>1){U=!0;break}for(var T=0;T<e.semesterGroupBeans.length;T++)for(var k=0;k<e.semesterGroupBeans[T].groupOptions.length;k++)for(var A=0;A<e.semesterGroupBeans[T].groupOptions[k].semestersInOption.length;A++){p=e.semesterGroupBeans[T].groupOptions[k].semestersInOption[A],collections=p.collections,semesterId=[T,k,A].join(""),"PG"==StirUniModules.getCourseType()?0===T&&0===k&&0===A?(w++,C.push(p.semesterName)):C.indexOf(p.semesterName)===-1&&0===k?C.push(p.semesterName):0===k&&(C=[],C.push(p.semesterName),w++):w=StirUniModules.semester.getYear(parseInt(p.semesterCode)),collections.sort(StirUniModules.moduleSort),h="Year "+w+", "+(p.semesterName?p.semesterName+" semester":"Semester "+StirUniModules.semester.getSemesterYearIndex(p.semesterCode)),U?(f=" (Option "+(k+1)+")",b.push({year:w,options:e.semesterGroupBeans[T].groupOptions.length})):f="",c.push('<div class="stir-accordion '+(l?" stir-accordion--active":"")+' ">'),c.push('<h3><a href="#" class="stir-accordion--btn" aria-expanded="'+(l?"true":"false")+'" aria-controls="panel_modules_'+semesterId+'" id="accord_modules_'+semesterId+'">'+h+f+"</a></h3>"),c.push('<div class="c-wysiwyg-content c-course-modules__collection '+StirUniModules.css.truncateModuleCollection+'" id="panel_modules_'+semesterId+'" role="region" aria-labelledby="accord_modules_'+semesterId+'">'),collectionHeaderChecksum=null;for(var O=0;O<collections.length;O++){m=collections[O],S=[],g=[T,k,A,O].join(""),S.push('<table class="text-left c-course-modules__table" id="course-modules__table_'+g+'">'),S.push('<tr class="show-for-sr">'),S.push("    <th>Module</th>"),S.push("    <th>Credits</th>"),S.push("</tr>"),M=!1;for(var x=0;x<m.mods.length;x++)u=m.mods[x],!StirUniModules.getOption("hide_modules_if_not_available")||null!==u.mavSemSemester&&0!==u.mavSemSemester.length&&"[n]"!==u.mavSemSemester&&"Not Available"!==u.mavSemSemester?(y=!0,M=!0):y=!1,(y||s)&&(S.push("<tr"+(y?"":' data-availability="false" style="border: 2px dashed tomato"')+">"),S.push('    <td><a href="'+StirUniModules.getDPTModuleLink(u.modCode)+'" data-modalopen="course__description" data-module-code="'+u.modCode+'" data-semester-code="'+u.mavSemCode+'" data-occurrence="'+u.mavOccurrence+'" data-year-session="'+u.mavSemSession+'">'+u.modName+'</a> <span class="c-course-modules__module-code">('+u.modCode+")</span></td>"),S.push("    <td>"+u.modCredit+" credits</td>"),S.push("</tr>"));S.push("    </table>"),(M||s)&&(v="LIST"==m.collectionType||"CHOICE"==m.collectionType,_=E(m.collectionStatusCode,m.collectionNotes)!==collectionHeaderChecksum,(!StirUniModules.getOptions().collapse_collection_headers||v||_)&&c.push('<p class="c-course-modules__collection-header">'+L(m.collectionStatusCode,m.collectionNotes)+"</p>"),v&&c.push('<p class="c-course-modules__collection-notes">'+m.collectionNotes+"</p>"),collectionHeaderChecksum=E(m.collectionStatusCode,m.collectionNotes),c.push(S.join("")),m.mods.length>viewMoreModulesThreshold&&(c.push('<p class="text-center c-course-modules__view-more-link">'),c.push('<a href="#" data-choices="'+m.mods.length+'" aria-expanded="false" aria-controls="course-modules__table_'+g+'">'),c.push(viewMoreLinkText.replace("_X_",m.mods.length)),c.push("</a></p>")),m.collectionFootnote&&c.push('<p class="c-course-modules__pdm-note">'+m.collectionFootnote+"</p>"))}c.push("  </div><!-- end .accordion-content -->"),c.push("</div>"),l=!1}if(d){var R=[],H=[];b.length>0&&(b.forEach(function(e){e.options>1&&R.indexOf(e.year)===-1&&(R.push(e.year),H.push(stir.cardinal(e.options)+" alternative paths in year "+stir.cardinal(e.year)))}),d.insertAdjacentHTML("afterbegin",'<p><strong><span class="uos-shuffle"></span> There are '+stir.Array.oxfordComma(H,!0)+".  Please review all options carefully.</strong></p>")),d.innerText&&(d.classList.add("c-callout"),d.classList.add("info"))}a.insertAdjacentHTML("beforeEnd",c.join("\n")),Array.prototype.forEach.call(a.querySelectorAll(".stir-accordion"),function(e){new stir.accord(e,(!0))}),Array.prototype.forEach.call(r.querySelectorAll(".c-course-modules__collection"),function(e){var t=e.querySelector(".c-course-modules__view-more-link a");t&&t.addEventListener("click",n.bind(e))}),document.querySelectorAll('[data-modalopen="course__description"]').forEach(function(e){e.addEventListener("click",i)})}}),StirUniModules.setShowModuleRenderer(function(e){function t(t){return e&&e[0]&&e[0].details&&e[0].details[t]}function o(){if(!n.data_modules_show_details_link)return"";var e=t("Module Code"),o=e?StirUniModules.getDPTModuleLink(e):"";return o?'<a href="'+o+'" class="button tiny" target="_blank">View full details of module '+e+"</a>":""}var n=StirUniModules.getOptions(),i=t("Module Name"),r=t("Brief (marketing) description")||t("Summary of Module");r?(r=r.replace(/<[font|u][^><]*>|<.[font|u][^><]*>/g,"").replace(/ style="([^"]+)"/gi,""),$("#course-modules-description__header").html('<h3 class="c-section-heading">'+i+"</h3>").show(),$("#course-modules-description__body").html(r+o()).show()):($("#course-modules-description__header").hide(),$("#course-modules-description__body").html("Module information coming soon").show()),$("#course-modules-description__loading").hide(),$("#course-modules-description__content").show()}),StirUniModules.setShowModuleErrorRenderer(function(e){$("#course-modules-description__header").html('<h3 class="c-section-heading">Error</h3>'),$("#course-modules-description__body").html("Module information not found"),$("#course-modules-description__loading").hide(),$("#course-modules-description__content").show()}),StirUniModules.setShowOptionsErrorRenderer(function(e){$("#course-modules-container").hide()}),StirUniModules.setShowLoadingRenderer(function(e){StirUniModules.loading.queue++,StirUniModules.loading.el.style.display="block"}),StirUniModules.setHideLoadingRenderer(function(e){StirUniModules.loading.queue>0&&StirUniModules.loading.queue--,0===StirUniModules.loading.queue&&(StirUniModules.loading.el.style.display="none")}),StirUniModules.initialisationRoutine=function(){var e=!1;return function(t){if(!e){var o,n,i,r=document.querySelector("[data-modules-route-code][data-modules-course-type]");if(r){n=r.getAttribute("data-modules-route-code"),o=r.getAttribute("data-modules-course-type"),i=null!==r.getAttribute("data-modules-show-details-link");var s=[],a=new stir.Modal;s.push('<div id="course-modules-description__loading"><div class="loader"></div></div>'),s.push('<div id="course-modules-description__content">'),s.push('<div id="course-modules-description__header"></div>'),s.push('<div id="course-modules-description__body"></div>'),s.push("</div>"),a.render("course__description","Module summary"),a.setContent(s.join("\n")),StirUniModules.init({container:"#course-modules-container",autoload_first_route:!0,autoload_first_option:!0,use_cache:!0,collapse_collection_headers:!1,hide_modules_if_not_available:!0,data_modules_show_details_link:i,modal:a}),StirUniModules.loadCourseRoutes(n,o),e=!0}}}}(),function(){var e=document.getElementById("course-tabs__course-details-label");e&&(e=e.parentElement);var t=window.location.href;t.indexOf("#")&&"course-tabs__course-details"===t.split("#")[1]&&StirUniModules.initialisationRoutine(),e&&e.addEventListener("click",StirUniModules.initialisationRoutine)}(),function(){function e(){"dev"===UoS_env.name&&(i="../data/courses-all.json",r="https://t4cms.stir.ac.uk/terminalfour/preview/1/en/857"),"preview"===UoS_env.name&&(i="https://t4cms.stir.ac.uk/terminalfour/preview/1/en/20892"),"prod"===UoS_env.name&&(r=r.replace("https://www.stir.ac.uk",""))}function t(e){var t="";return""!==e.code.trim()&&(t=" <strong>UCAS Code: "+e.code.trim()+"</strong>"),'<li><a href="'+e.url+'">'+e.prefix+" "+e.title+"</a>"+t+"</li>"}var o=document.querySelector("[data-course-related]"),n=document.querySelector(".c-course-related__wrapper"),i="/data/courses/all-courses/index.json",r=window.location.href;r=r.split("?")[0],r=r.split("#")[0];var s=function(e,t){e.onclick=function(e){window.location=t}},a=function(e){var i=[],a=document.querySelector("[data-subjects]").dataset.subjects,c=document.querySelector("[data-modules-course-type]").dataset.modulesCourseType;if(""===a.trim())return void n.parentNode.removeChild(n);"UG"===c&&(c="Undergraduate"),"PG"===c&&(c="Postgraduate");var d=a.split(","),l=e.courses;e="";for(var u=l.sort(function(e,t){return e.title<t.title?-1:e.title>t.title?1:0}),m=0;m<u.length;m++)for(var p=0;p<d.length;p++)if(u[m].subject&&c&&u[m].subject.trim().indexOf(d[p].trim())>-1&&u[m].level.trim()===c&&r!==u[m].url){i.push(t(u[m]));break}if(i.length>0&&(i.unshift("<ul>"),i.push("</ul>"),o.innerHTML=i.join("\n")),i.length<1)return void n.parentNode.removeChild(n);var h=document.querySelectorAll(".c-course-related__buttons ul li"),f="";if(h.length>0)for(var m=0;m<h.length;m++)h[m].children[0]&&h[m].children[0].hasAttribute("href")&&(f=h[m].children[0].attributes.href.value,s(h[m],f))};o&&(e(),stir.getJSON(i,a))}(),function(){var e=function(e,t){for(var o,n,i=document.getElementById(e),r=!1,s=i;!r&&null!==s;)s.classList&&s.classList.contains("stir-tabs__content")&&(o=s.previousElementSibling,r=!0),s=s.parentNode;o&&(o.classList.contains("stir-tabs__tab--active")||o.click());for(var a=!1,c=i;!a&&null!==c;)c.classList&&c.classList.contains("stir-accordion")&&(n=c.children[0].children[0],a=!0),c=c.parentNode;n&&"false"===n.getAttribute("aria-expanded")&&n.click(),history.pushState(null,null,"#"+e),i&&stir.scrollToElement(i,t)},t=function(t){t.onclick=function(t){var o=this.href.split("#")[1];if(document.getElementById(o)&&void 0!==o){var n=100,i=stir.MediaQuery.current;return"medium"===i&&(n=150),"small"===i&&(n=15),e(o,n),t.preventDefault(),!1}}},o=document.querySelector(".c-course__alt-apply-now-button");if(o){var n=o.getAttribute("href").split("#")[1];if(!document.getElementById(n)){if("prod"!==UoS_env.name){var i=document.querySelector(".c-course-title__buttons");i&&i.insertAdjacentHTML("beforeend",'<p class="alert callout ">WARNING!! Apply now button location ID ('+n+") is missing. Tell a dev!!</p>")}"prod"===UoS_env.name&&o.classList.add("hide")}t(o)}var r=document.getElementsByClassName("skip-link");if(r)for(var s=0;s<r.length;s++)t(r[s])}();