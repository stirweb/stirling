<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Personalisation | University of Stirling</title>

    <meta property="og:site_name" content="University of Stirling" />
    <meta property="og:url" content="https://www.stir.ac.uk/about/business/training-and-skills-development/" />
    <meta property="og:title" content="Training and skills development | About | University of Stirling" />
    <meta property="og:image" content="https://www.stir.ac.uk/media/stirling/global-assets/landscape/og-airthrey-loch-1200x630.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:description" content="We offer a range of training and development opportunities to help your staff grow your business. Upskill your staff now." />
    <meta name="stir.title" content="Training and skills development" />
    <meta name="description" content="We offer a range of training and development opportunities to help your staff grow your business. Upskill your staff now." />
    <meta name="Page last modified" content="2023-04-28" />
    <link rel="canonical" href="https://www.stir.ac.uk/about/business/training-and-skills-development/" />
    <meta name="stir.breadcrumb" content="Home > About > Business and enterprise > Training and skills development" />
    <meta name="sid" content="32496" />
    <meta name="chid" content="1" />
    <meta name="t4name" content="Training and skills development" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@StirUni" />
    <meta name="twitter:title" content="Training and skills development | About | University of Stirling" />
    <meta name="twitter:description" content="We offer a range of training and development opportunities to help your staff grow your business. Upskill your staff now." />
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#006938" />

    <link rel="preload" href="../../../medias/Categorised/Dist/fonts/fsmaja/FSMajaWeb-Regular.woff" as="font" type="font/woff" crossorigin />
    <link rel="preload" href="../../../medias/Categorised/Dist/fonts/general-sans/GeneralSans-Bold.ttf" as="font" type="font/ttf" crossorigin />
    <link rel="preload" href="../../../medias/Categorised/Dist/fonts/general-sans/GeneralSans-Regular.ttf" as="font" type="font/ttf" crossorigin />
    <link rel="preload" href="../../../medias/Categorised/Dist/fonts/fonts.css?v=7.1" as="style" />
    <link rel="stylesheet" href="../../../medias/Categorised/Dist/fonts/fonts.css?v=7.1" />

    <link rel="preload" href="../../../medias/Categorised/Dist/css/app.min.css?v=391.1" as="style" />
    <link rel="stylesheet" href="../../../medias/Categorised/Dist/css/app.min.css?v=391.1" />

    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://load.collect.stir.ac.uk/qguyvksw.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-NLVN8V");
    </script>
  </head>
  <body class="external-pages">
    <!--beginnoindex-->
    <nav class="skip-nav-btn" aria-label="Skip to content navigation"><a href="#content">skip to main content</a></nav>

    <!--
		MOBILE NAV
	-->
    <nav id="mobile-menu-2" class="c-mobile-menu u-bg-grey" aria-label="Mobile navigation">
      <a href="#" id="close_mobile_menu" class="closebtn" title="Close mobile menu">&times;</a>
      <ul class="sitemenu-2 no-bullet u-bg-white">
        <li class="u-underline u-energy-teal--light">
          <a href="/" class="button no-arrow button--left-align clear expanded u-m-0 text-left" data-action="go">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1">Home</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
        <li class="u-underline u-energy-teal--light">
          <a href="/courses/" class="button no-arrow button--left-align clear expanded u-m-0 text-left">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1"> Find a course</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
        <li class="u-underline u-energy-teal--light">
          <a href="/subjects/" class="button no-arrow button--left-align clear expanded u-m-0 text-left">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1">University courses by subject</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
        <li class="u-underline u-energy-teal--light">
          <a href="/study/" class="button no-arrow button--left-align clear expanded u-m-0 text-left">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1">Study</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
        <li class="u-underline u-energy-teal--light">
          <a href="/international/" class="button no-arrow button--left-align clear expanded u-m-0 text-left">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1">International</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
        <li class="u-underline u-energy-teal--light">
          <a href="/research/" class="button no-arrow button--left-align clear expanded u-m-0 text-left">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1">Research</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
        <li class="u-underline u-energy-teal--light">
          <a href="/about/" class="button no-arrow button--left-align clear expanded u-m-0 text-left">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1">About</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
        <li class="u-underline u-energy-teal--light">
          <a href="/student-life/" class="button no-arrow button--left-align clear expanded u-m-0 text-left">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1">Student life</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
        <li class="u-underline u-energy-teal--light">
          <a href="/clearing/" class="button no-arrow button--left-align clear expanded u-m-0 text-left">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1"> Clearing</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
        <li class="u-underline u-energy-teal--light">
          <a href="/scholarships/" class="button no-arrow button--left-align clear expanded u-m-0 text-left">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1"> Scholarships</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
        <li class="u-underline u-energy-teal--light">
          <a href="/news/" class="button no-arrow button--left-align clear expanded u-m-0 text-left">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1"> News</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
        <li class="u-underline u-energy-teal--light">
          <a href="/events/" class="button no-arrow button--left-align clear expanded u-m-0 text-left">
            <div class="u-flex align-middle u-gap-16">
              <span class="u-flex1"> Events</span>
              <span class="u-chevron-right u-icon"></span>
            </div>
          </a>
        </li>
      </ul>

      <!-- Secondary popular links -->
      <ul class="slidemenu__other-links no-bullet u-p-3 u-flex u-mt-2 flex-dir-column u-gap-16">
        <li class="text-sm">
          <a href="/favourites/" rel="nofollow" class="u-flex u-gap-16 align-middle u-svg-24">
            <svg version="1.1" data-stiricon="heart-inactive" fill="currentColor" viewBox="0 0 50 50" class="svg-icon">
              <path
                d="M44.1,10.1c-4.5-4.3-11.7-4.2-16,0.2L25,13.4l-3.3-3.3c-2.2-2.1-5-3.2-8-3.2c0,0-0.1,0-0.1,0c-3,0-5.8,1.2-7.9,3.4
               c-4.3,4.5-4.2,11.7,0.2,16l18.1,18.1c0.5,0.5,1.6,0.5,2.1,0l17.9-17.9c0.1-0.2,0.3-0.4,0.5-0.5c2-2.2,3.1-5,3.1-7.9
               C47.5,15,46.3,12.2,44.1,10.1z M42,24.2l-17,17l-17-17c-3.3-3.3-3.3-8.6,0-11.8c1.6-1.6,3.7-2.4,5.9-2.4c2.2-0.1,4.4,0.8,6,2.5
               l4.1,4.1c0.6,0.6,1.5,0.6,2.1,0l4.2-4.2c3.4-3.2,8.5-3.2,11.8,0C45.3,15.6,45.3,20.9,42,24.2z"
              ></path>
            </svg>
            <span>My favourites</span></a
          >
        </li>

        <li class="text-sm">
          <a href="https://portal.stir.ac.uk/my-portal.jsp" rel="nofollow" class="u-flex u-gap-16 align-middle u-svg-24">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2" stroke="currentColor">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"
              />
            </svg>
            <span>My Portal</span></a
          >
        </li>

        <li class="text-sm">
          <a href="/about/contact-us/" class="u-flex u-gap-16 align-middle u-svg-24">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2" stroke="currentColor">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"
              />
            </svg>
            <span>My Contact</span></a
          >
        </li>

        <li class="text-sm">
          <a href="/search/" class="u-flex u-gap-16 align-middle u-svg-24">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
            </svg>
            <span>Search our site</span></a
          >
        </li>

        <li class="text-sm">
          <a href="http://stirlinguni.cn/" data-microsite="cn" class="u-flex u-gap-16 align-middle u-svg-24">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2" stroke="currentColor">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"
              />
            </svg>
            <span>中文网</span></a
          >
        </li>
      </ul>
    </nav>

    <!--
		MAIN HEADER
	-->
    <header class="c-header" id="layout-header" aria-label="Main header">
      <div class="grid-x grid-container">
        <div class="cell large-4 medium-4 small-8">
          <a href="/" title="University of Stirling">
            <img
              src="https://pxl-v6-stiracuk.terminalfour.net/prod01/cdn../../../medias/Categorised/Dist/css/images/logos/logo.svg"
              alt="University of Stirling"
              class="c-site-logo"
            />
          </a>
        </div>
        <nav aria-label="primary" class="cell large-8 medium-8 small-4 u-flex align-right">
          <div class="u-flex flex-dir-column align-bottom align-center">
            <ul class="c-header-nav--secondary u-font-semibold u-flex align-middle">
              <!-- My Favourites -->
              <li class="c-header-nav__item show-for-large u-relative">
                <a class="c-header-nav__link u-flex align-middle u-gap-8 u-svg-16" href="/favourites/">
                  <svg version="1.1" data-stiricon="heart-inactive" fill="currentColor" viewBox="0 0 50 50" class="svg-icon">
                    <path
                      d="M44.1,10.1c-4.5-4.3-11.7-4.2-16,0.2L25,13.4l-3.3-3.3c-2.2-2.1-5-3.2-8-3.2c0,0-0.1,0-0.1,0c-3,0-5.8,1.2-7.9,3.4
               c-4.3,4.5-4.2,11.7,0.2,16l18.1,18.1c0.5,0.5,1.6,0.5,2.1,0l17.9-17.9c0.1-0.2,0.3-0.4,0.5-0.5c2-2.2,3.1-5,3.1-7.9
               C47.5,15,46.3,12.2,44.1,10.1z M42,24.2l-17,17l-17-17c-3.3-3.3-3.3-8.6,0-11.8c1.6-1.6,3.7-2.4,5.9-2.4c2.2-0.1,4.4,0.8,6,2.5
               l4.1,4.1c0.6,0.6,1.5,0.6,2.1,0l4.2-4.2c3.4-3.2,8.5-3.2,11.8,0C45.3,15.6,45.3,20.9,42,24.2z"
                    ></path>
                  </svg>
                  <span>My favourites</span></a
                >
              </li>

              <!-- China microsite -->
              <li class="c-header-nav__item show-for-medium">
                <a class="c-header-nav__link" href="https://stirlinguni.cn/" data-microsite="cn">中文网</a>
              </li>

              <!-- My Portal -->
              <li class="c-header-nav__item show-for-large">
                <a class="c-header-nav__link" href="https://portal.stir.ac.uk/my-portal.jsp" rel="nofollow" id="header-portal__button">My Portal</a>
              </li>

              <!-- Search -->
              <li class="c-header-nav__item u-flex">
                <a class="c-header-nav__link u-flex align-middle u-gap-8" id="header-search__button" href="/search/">
                  <span class="show-for-medium">Site search</span>
                  <span class="show-for-small-only show-for-sr">Site search</span>

                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="#333"
                    class="svg-icon u-svg-16 hide-for-medium-only hide-for-small-only"
                  >
                    <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                  </svg>
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="#333" class="svg-icon u-svg-24 hide-for-large">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                  </svg>
                </a>
              </li>

              <!-- Burger -->
              <li class="c-header-nav__item u-flex hide-for-xlarge">
                <a href="#" id="open_mobile_menu" class="u-flex align-middle">
                  <span class="show-for-sr">Show/hide mobile menu</span>

                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="#333" class="u-svg-40 u-relative">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                  </svg>
                </a>
              </li>
            </ul>

            <!-- Mega menu links -->
            <ul class="c-header-nav c-header-nav--primary u-font-bold show-for-xlarge u-mb-0">
              <li class="c-header-nav__item">
                <a class="c-header-nav__link" data-menu-id="mm__study" href="/study/">Study</a>
              </li>
              <li class="c-header-nav__item">
                <a class="c-header-nav__link" data-menu-id="mm__international" href="/international/">International</a>
              </li>
              <li class="c-header-nav__item">
                <a class="c-header-nav__link" data-menu-id="mm__research" href="/research/">Research</a>
              </li>
              <li class="c-header-nav__item">
                <a class="c-header-nav__link" data-menu-id="mm__about" href="/about/">About</a>
              </li>
              <li class="c-header-nav__item">
                <a class="c-header-nav__link" data-menu-id="mm__student-life" href="/student-life/">Student life</a>
              </li>
            </ul>
          </div>
        </nav>
      </div>
      <form
        id="header-search"
        class="c-header-search"
        aria-hidden="true"
        aria-label="Popup for site search field"
        method="get"
        action="https://search.stir.ac.uk/s/search.html?collection=stir-main"
        data-js-action="/search/"
      >
        <!--  <input type="hidden" name="collection" value="external">-->
        <!-- <input type="hidden" name="meta_group_not" value="internal"> -->

        <div class="overlay"></div>
        <div class="content">
          <div class="grid-container">
            <div class="grid-x">
              <div class="small-12 small-12 cell c-header-search__input-wrapper">
                <label class="show-for-sr" for="header-search__query">Site search</label>
                <input type="search" name="query" id="header-search__query" class="c-header-search__query" autocomplete="off" placeholder="Site search" tabindex="-1" />

                <button class="button no-arrow u-m-0 u-p-1 u-min-w-none" type="submit" title="submit search term" aria-label="submit" tabindex="-1">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="svg-icon u-svg-24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <div class="u-bg-grey">
            <div class="grid-container">
              <div class="grid-x">
                <div class="small-12 small-12 cell u-relative">
                  <div id="header-search__wrapper" class="c-header-search__wrapper hide-for-small-only" aria-hidden="true">
                    <div id="header-search__results" class="grid-x c-header-search__results">
                      <div class="cell medium-4 c-header-search__column c-header-search__suggestions"></div>

                      <div class="cell medium-4 c-header-search__column c-header-search__news"></div>

                      <div class="cell medium-4 c-header-search__column c-header-search__courses"></div>
                    </div>
                    <div id="header-search__loading" class="c-search-loading">
                      <div class="c-search-loading__spinner"></div>
                      <span class="show-for-sr">Loading...</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
      <nav id="megamenu__container" aria-label="primary navigation submenu"></nav>
    </header>

    <!--
		BREADCRUMB
	-->

    <nav aria-label="breadcrumb" class="breadcrumbs-container u-bg-grey">
      <div class="grid-x grid-container">
        <div class="cell">
          <ul class="breadcrumbs">
            <li>
              <a href="/" title="home page">
                <span class="hide-for-medium">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2" stroke="currentColor" class="home-icon">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"
                    />
                  </svg>
                </span>
                <span class="show-for-medium">Home</span></a
              >
            </li>
            <li>
              <a href="/about/">About</a>
              <ul>
                <li><a href="/about/our-reputation/">Our reputation</a></li>
                <li><a href="/about/strategic-plan/">Strategic Plan</a></li>
                <li><a href="/about/our-history/">Our history</a></li>
                <li><a href="/about/our-people/">Our people</a></li>
                <li><a href="/about/faculties/">Faculties</a></li>
                <li><a href="/about/forth2o/">FORTH2O</a></li>
                <li><a href="/about/work-at-stirling/">Jobs at Stirling</a></li>
                <li><a href="/about/business/">Business and enterprise</a></li>
                <li><a href="/about/professional-services/">Professional services</a></li>
                <li><a href="/about/sustainability/">Sustainability</a></li>
                <li><a href="/about/scotlands-international-environment-centre/">Scotland's International Environment Centre</a></li>
                <li><a href="/about/city-region-deal/">City Region Deal</a></li>
                <li><a href="/news/">News</a></li>
                <li><a href="/events/">Events</a></li>
                <li><a href="/about/publications/">Publications</a></li>
                <li><a href="/about/art-collection/">Art Collection</a></li>
                <li><a href="/about/psychology-kindergarten/">Psychology Kindergarten</a></li>
                <li><a href="/about/getting-here/">Getting here</a></li>
                <li><a href="/about/contact-us/">Contact us</a></li>
              </ul>
            </li>
            <li>
              <a href="/about/business/">Business and enterprise</a>
              <ul>
                <li><a href="/about/business/start-up-entrepreneur-support/">Support for start-ups and entrepreneurs</a></li>
                <li><span class="currentsection">Training and skills development</span></li>
                <li><a href="/about/business/funding-and-grants/">Funding and grants</a></li>
                <li><a href="/about/business/innovation-research-and-development/">Innovation, research and development</a></li>
                <li><a href="/student-life/careers/employers/">Work with our students</a></li>
                <li><a href="/student-life/careers/employers/recruiting-our-students/">Recruit our students</a></li>
                <li><a href="/about/business/business-services/">Business services</a></li>
                <li><a href="/about/faculties/stirling-business-school/engaging-with-business/">Stirling Business School</a></li>
                <li><a href="/about/scotlands-international-environment-centre/">Scotland's International Environment Centre</a></li>
                <li><a href="https://www.suip.co.uk/">Innovation Park</a></li>
              </ul>
            </li>
            <li>
              <a href="/about/business/training-and-skills-development/">Training and skills development</a>
              <ul>
                <li><a href="/about/business/training-and-skills-development/help-to-grow-management-course/">Help To Grow Management Course</a></li>
                <li><a href="/about/business/training-and-skills-development/ga-data-employer-info/">Graduate Apprenticeship in Data Science: Information for employers</a></li>
              </ul>
            </li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
        </div>
      </div>
    </nav>

    <!--endnoindex-->

    <!-- 
		MAIN CONTENT 
	-->
    <main class="wrapper-content" aria-label="Main content" id="content">
      <div class="grid-x grid-container">
        <div class="cell main-content-header large-10 medium-10 small-12 u-padding-y">
          <h1 class="c-automatic-page-heading c-page-heading u-heritage-green">Personalisation</h1>
          <p class="u-mt-2">
            Lorem ipsum dolor sit amet consectetur adipisicing elit. Aliquam sapiente nesciunt molestias deserunt at eveniet eaque, accusantium perferendis rem fugiat recusandae a
            voluptates adipisci officiis ab hic nobis inventore blanditiis?
          </p>
        </div>

        <div class="cell small-12 medium-10 large-10 u-bleed u-bg-grey bg-grey u-padding-y" id="personalisation-1">
          <h2>Course page more than 3 times</h2>
          <p>
            Below there will be personalised messages based on your browsing history. If you have <b>viewed the same course page more than 3 times</b>, a promo will be shown for
            that course.
          </p>
        </div>

        <div class="cell u-bleed u-bg-grey bg-grey u-padding-y" id="personalisation-2">
          <h2>Three course pages in one session</h2>
          <p>If you have <b>viewed more than 3 course pages in one session</b>, a promo will be shown for the upcoming Open Day.</p>
        </div>

        <div class="cell u-bleed u-bg-grey bg-grey u-padding-y" id="personalisation-3">
          <h2>Course page plus prospectus</h2>
          <p>
            If you have <b>repeated visits to a specific course page plus downloaded a prospectus</b>, an apply banner will be shown for that course. By default it will show the
            most visited course.
          </p>
          <a id="downloadProspectusBtn" href="https://www.stir.ac.uk/research/hub/pdfs/stirling-undergraduate-prospectus-2026-accessible.pdf" class="heritage-green button"
            >2026 undergraduate guide (PDF)</a
          >
        </div>
      </div>
    </main>

    <!--beginnoindex-->
    <!-- 
				 MAIN FOOTER 
				-->

    <!--endnoindex-->

    <!-- app.min.js -->
    <script type="text/javascript" src="../../../medias/Categorised/Dist/js/app.min.js?v=134.1"></script>

    <script>
      /**
       * VARS
       */
      const storageKey = "stirsess";
      const visitThreshold = 3;

      /**
       * Cookie helper functions
       */
      const setCookie = (name, value, days) => {
        let expires = "";
        if (days) {
          const date = new Date();
          date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);
          expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (value || "") + expires + "; path=/";
      };

      const getCookie = (name) => {
        const nameEQ = name + "=";
        const ca = document.cookie.split(";");
        for (let i = 0; i < ca.length; i++) {
          let c = ca[i];
          while (c.charAt(0) === " ") c = c.substring(1, c.length);
          if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
      };

      /**
       * Retrieves the session data from a cookie.
       * @param {string} key - The name of the cookie.
       * @returns {Array} - The array of page objects from the session data.
       */
      const getSessionData = (key) => {
        try {
          const storedData = getCookie(key);
          const parsedData = storedData ? JSON.parse(storedData) : { pages: [] };
          return Array.isArray(parsedData.pages) ? parsedData.pages : [];
        } catch (e) {
          console.error("Error parsing session data from cookie:", e);
          return [];
        }
      };

      /**
       * Retrieves the prospectus status from the session data.
       * @returns {boolean} - True if the prospectus was downloaded, false otherwise.
       */
      const getProspectusStatus = (sessionData) => {
        //const sessionData = getSessionData("stirsess");
        return sessionData.some((page) => page.id === "prospectus");
      };

      /**
       * Counts the number of visits to each page by its ID.
       * @param {Array} pages - Array of page objects with properties: t (type), d (date), id (course ID).
       * @returns {Object} - An object mapping page IDs to their visit counts.
       */
      const countVisitsById = (pages) =>
        pages.reduce((acc, page) => {
          acc[page.id] = (acc[page.id] || 0) + 1;
          return acc;
        }, {});

      /**
       * Finds the IDs of pages that were visited more than the specified threshold.
       * @param {Object} visitCounts - An object mapping page IDs to their visit counts.
       * @param {number} threshold - The visit count threshold.
       * @returns {Array} - An array of page IDs that were visited more than the threshold.
       */
      const findFrequentPages = (visitCounts, threshold) => Object.keys(visitCounts).filter((id) => visitCounts[id] > threshold);

      /**
       * Checks if the user has viewed more than 3 unique course pages in the last 24 hours.
       * @param {Array} pages - Array of page objects with properties: t (type), d (date), id (course ID).
       * @returns {boolean} - True if more than 3 unique course pages were viewed in the last 24 hours, false otherwise.
       */
      const hasRecentCourseVisit = (date, pages) => {
        const recentCourseVisits = pages.filter((page) => page.t === "c" && new Date(page.d) > date);
        const uniqueCourseIds = [...new Set(recentCourseVisits.map((page) => page.id))];

        return uniqueCourseIds.length > 3;
      };

      /**
       * Renders the Open Day promotional message.
       * @returns {HTMLElement} - The created Open Day promo element.
       */
      const renderOpenDayPromo = () => {
        const container = document.createElement("div");
        container.className = "u-my-2 cell medium-12 ";
        container.innerHTML = `<div class="grid-x grid-container flex-dir-column medium-flex-dir-row u-p-2 u-m-0 c-wrapper-2025 purples dark">
                                    <p class="cell small-12 large-8 u-m-0 u-font-primary text-center text-xlg-fixed ">Register for our Open Day</p>
                                    <p class="cell small-12 large-4 u-m-0"><a href="/study/visit-us/" class="button tinted u-m-0 u-p-1 expanded">Join us now</a></p>
                                </div>`;
        return container;
      };

      /**
       * Creates a message element for a specific course page.
       * @param {string} pageId - The ID of the course page.
       * @returns {HTMLElement} - The created message element.
       */
      const renderCoursePromo = (page, index) => {
        if (index > 3) return document.createElement("span");

        const images = [
          `<t4 type="media" formatter="image/*" id="180765" />`,
          `<t4 type="media" formatter="image/*" id="175440" />`,
          `<t4 type="media" formatter="image/*" id="175406" />`,
          `<t4 type="media" formatter="image/*" id="172475" />`,
        ];

        const image = UoS_env.name === "dev" ? `<img src="image-${index + 1}.webp" alt="" />` : images[index];

        const link = page?.webinar[0] ? page.webinar[0].link : page.liveUrl;
        const linkText = page?.webinar[0] ? "Join course webinar" : "Have a call with an academic";

        const container = document.createElement("div");
        container.className = "u-bg-grey u-my-2 cell medium-6 large-4";

        container.innerHTML = `${image}
                               <div class="u-p-1">
                                <p><b>${page.metaData.award} ${page.title}</b></p>
                                <a class="c-link" href="${link}">${linkText}</a>
                               </div>`;
        return container;
      };

      /**
       * Displays promotional messages for courses based on the viewed pages.
       * @param {Array} pages - Array of page objects with properties: t (type), d (date), id (course ID).
       * @param {HTMLElement} targetElement - The element to insert the promotional messages after.
       */
      const displayCoursePromo = (pages, targetElement) => {
        if (!targetElement) return;
        pages.map((page, index) => renderCoursePromo(page, index)).forEach((element) => targetElement.after(element));
      };

      /**
       * Renders the course application promotional message.
       * @param {Object} page - The course page object.
       * @param {number} index - The index of the course page.
       * @returns {HTMLElement} - The created course application promo element.
       */
      const renderCourseApplyPromo = (page, index) => {
        if (index > 0) return document.createElement("span");

        const starts = "03 " + page.metaData.start.split("|")[0];
        const daysTillStarts = Math.ceil((new Date(starts) - new Date()) / (1000 * 60 * 60 * 24));

        const link = page.liveUrl;
        const linkText = "Apply now";

        const container = document.createElement("div");
        container.className = "u-bg-grey u-my-2 cell  ";

        container.innerHTML = `<div class="grid-x grid-container flex-dir-column medium-flex-dir-row u-p-2 u-m-0 c-wrapper-2025 blues dark">
                                <p class="cell small-12 large-8 u-m-0 u-font-primary ">
                                    <span class="text-md  u-font-secondary"><b>${page.metaData.award} ${page.title}</b></span><br/>
                                    <span class="text-xlg-fixed">Applications close in ${daysTillStarts} days</span>
                               </p>
                               <p class="cell small-12 large-4 u-m-0"> <a class="button expanded" href="${link}">${linkText}</a>
                               </div></div>`;
        return container;
      };

      /**
       * Displays promotional messages for course applications based on the viewed pages.
       * @param {Array} pages - Array of page objects with properties: t (type), d (date), id (course ID).
       * @param {HTMLElement} targetElement - The element to insert the promotional messages after.
       */
      const displayCourseApplyPromo = (pages, targetElement) => {
        if (!targetElement) return;
        pages.map((page, index) => renderCourseApplyPromo(page, index)).forEach((element) => targetElement.after(element));
      };

      function getWebinarsApiUrl(env) {
        switch (env) {
          case "dev":
            return "../events/webinars-2024/index.json";
          case "preview":
            return '<t4 type="navigation" id="5271" />';
          case "appdev-preview":
            return '<t4 type="navigation" id="5271" />';
          default:
            return '<t4 type="navigation" id="5271" />' + "index.json";
        }
      }

      /**
       * Controller
       * Initializes the personalisation features.
       */
      const initPersonalisation = () => {
        const sessionData = getSessionData(storageKey);

        // Open Day Promo
        const openDayPromoArea = stir.node("#personalisation-2");
        const twentyFourHoursAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);
        const recentlyViewedCourse = hasRecentCourseVisit(twentyFourHoursAgo, sessionData);

        if (recentlyViewedCourse) {
          const container = renderOpenDayPromo();
          openDayPromoArea && openDayPromoArea.after(container);
        }

        // Course Page promos
        const visitCounts = countVisitsById(sessionData);

        const frequentPageIds = findFrequentPages(visitCounts, visitThreshold);
        const coursePromoArea = stir.node("#personalisation-1");

        // Get the page data from Funnelback
        const query = frequentPageIds.join("+");
        const fbhost = UoS_env.name === "prod" || UoS_env.name === "dev" ? "https://search.stir.ac.uk" : "https://stage-shared-15-24-search.clients.uk.funnelback.com";
        const fbUrl = `${fbhost}/s/search.json?collection=stir-main&num_ranks=50&SF=[sid,type,award,start,register,page]&query=&meta_sid_or=${query}`;

        // Funnelback search
        stir.getJSON(fbUrl, (results) => {
          const coursePages = results?.response?.resultPacket?.results || [];

          if (!coursePages.length) return;

          if (coursePromoArea) {
            const webinarsJson = getWebinarsApiUrl(UoS_env.name);

            stir.getJSON(webinarsJson, (webinars) => {
              if (!webinars || !Array.isArray(webinars)) return;

              // Course webinar promos
              const mergedResults = coursePages.map((course) => ({
                ...course,
                webinar: webinars.filter((item) => item.breadcrumb === course.liveUrl.replace("https://www.stir.ac.uk", "")),
                visitCounts: visitCounts[Number(course.metaData.sid)] || 0,
              }));

              mergedResults.sort((a, b) => b.visitCounts - a.visitCounts);

              if (mergedResults.length > 0) {
                displayCoursePromo(mergedResults, coursePromoArea);
              }

              // Apply promos
              const applyPromoArea = stir.node("#personalisation-3");
              const prospectusDownloaded = getProspectusStatus(sessionData);

              if (prospectusDownloaded && applyPromoArea) {
                displayCourseApplyPromo(mergedResults, applyPromoArea);
              }
            });
          }
        });
      };

      initPersonalisation();
    </script>

    <script>
      const downloadProspectusBtn = stir.node("#downloadProspectusBtn");

      downloadProspectusBtn.addEventListener("click", (e) => {
        //e.preventDefault();
        const storageKey = "stirsess";
        try {
          const storedData = getCookie(storageKey);
          const sessionData = storedData ? JSON.parse(storedData) : { pages: [] };

          const newProspectusEntry = {
            id: "prospectus",
            t: "p", // 'p' for prospectus
            d: new Date().toISOString(),
          };

          const updatedPages = [newProspectusEntry, ...(sessionData.pages || [])];

          const updatedData = { ...sessionData, pages: updatedPages };

          setCookie(storageKey, JSON.stringify(updatedData), 365); // Set cookie for 1 year
        } catch (e) {
          console.error("Error updating cookie:", e);
        }
      });
    </script>
  </body>
</html>
